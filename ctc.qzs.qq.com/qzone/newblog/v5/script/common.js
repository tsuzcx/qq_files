try{if(top.g_iframeUser){QZONE.FP=top.QZONE.FP}}catch(e){}var SPACE_MAIN_DOMAIN="base.qzone.qq.com";var SPACE_MAIN_READ_DOMAIN="r.qzone.qq.com";var SPACE_MAIN_WRITE_DOMAIN="w.qzone.qq.com";var CGI_BLOG_DOMAIN="b.qzone.qq.com";var CGI_BLOG_R_DOMAIN=!!/pengyou\.com$/.test(location.hostname)?"br."+QZONE.FP._t.g_DPrefix+"pengyou.com":"br."+QZONE.FP._t.g_DPrefix+"qzone.qq.com";var IMGCACHE_DOMAIN=parent.imgcacheDomain;var STYLE_DOMAIN=parent.siDomain;var CGI_MSGBOARD_DOMAIN="m.qzone.qq.com";var CGI_MSGBOARD_PATH="/cgi-bin/new/";var CGI_BLOG_PATH="/cgi-bin/blognew";var CGI_PRIVATEBLOG_PATH="/cgi-bin/privateblog";var CGI_DRAFT_PATH="/cgi-bin/draft";var IMGCACHE_BLOG_V5_PATH="/qzone/newblog/v5";var IMGCACHE_BLOG_V6_PATH="/qzone/app/blog/v6";var IMGCACHE_BLOG_PENGYOU_PATH="/qzone/app/blog/pengyou";var IMGCACHE_BLOG_PATH="/qzone/newblog";var CONTENT_COMMENT_NUM=QZONE.FP.getQzoneConfig().ownerUin==19990210?45:15;var MSGCNT_PER_PAGE=6;var MAX_COMMENT_LEN=4500;var MAX_BLOG_LEN=150*1024
;var MAX_BLOG_HTML_LEN=300*1024;var MAX_BLOG_TITLE_LEN=128;var BLOG_VERIFY_CODE=8000103;var MSG_VERIFY_CODE=8000102;var LIST_TITLE_NUM=15;var VERIFY_DOMAIN="ptlogin2.qq.com";var DEFAULT_PORTRAIT_IMGURL="/qzone_v4/client/userinfo_icon/5001.gif";var LOADING_GIF="/qzone/newblog/v5/editor/css/loading.gif";var BOARD_INFO_URL="//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/board.html";var INSERT_MEDIA_FORBIDDEN=false;var CLICK_STREAM_RATE=.3;var FRAME_ID="tblog";var MSG_FRAME_ID="tgb";var FRONT_AUTO_DRAFT_LENGTH=2;if(!window.console){window.console={log:function(){},print:function(){},dir:function(){}}}if(!QZFL.console.log){QZFL.console.log=QZFL.emptyFn}if(QZONE.FP._t.g_sdms["b.qzone.qq.com"]){CGI_BLOG_DOMAIN="b.qzone.qq.com"}if(QZONE.FP._t.g_sdms["br.qzone.qq.com"]){CGI_BLOG_R_DOMAIN="br.qzone.qq.com"}function reportAtta(e,t){try{var o=new Image(1,1);var i=location.search.match(/blogid=(\d+)/);var n=i&&i[1]||""
;o.src="https://h.trace.qq.com/kv?attaid=01a00032348&token=7354597577"+"&uin="+QZBlog.Logic.SpaceHostInfo.getUin()+"&command="+n+"&resulttype="+e+"&resultcode="+t+"&platform=qzoneBlogVideo"+"&_dc="+Math.random()}catch(e){}}var PAGE_CACHE={BLOG_CACHE_MASTER_KEY:"QZONE_BLOG_CACHE_MANAGER",BLOG_CACHE_KEY_LIST:"QZONE_BLOG_CACHE_MANAGER_KEY_LIST",CACHE_WIN:QZONE.FP._t,add:function(e,t,o){try{if(!this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]){this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]={};this.CACHE_WIN[this.BLOG_CACHE_KEY_LIST]={}}this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY][e]={data:t,expired:parseInt(o,10)*1e3+(new Date).getTime()};this.CACHE_WIN[this.BLOG_CACHE_KEY_LIST][e]=true;return true}catch(e){return false}},get:function(e){try{var t=QZONE.FP._t[this.BLOG_CACHE_MASTER_KEY][e];if(t){if(!t.expired||t.expired<0){return t.data}else{var o=(new Date).getTime();if(t.expired>o){return t.data}else{this.remove(e);return null}}}}catch(e){}return null},remove:function(e){try{
this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY][e]=undefined}catch(e){console.log(e)}},clean:function(e){if(e){this.remove(e)}else{try{this.CACHE_WIN[this.BLOG_CACHE_MASTER_KEY]=undefined}catch(e){console.log(e)}}}};var blogLoginFnList=[];function loginCallback(){try{while(blogLoginFnList.length>0){blogLoginFnList.shift()()}}catch(e){}}function getParentByClass(e,t){try{while(e&&e.offsetParent){if(e.className.indexOf(t)>=0){return e}e=e.offsetParent}}catch(e){}return null}function getElementsByTagName(e,t,o){e=e||document;var i=new Array;var n=e.getElementsByTagName(t);for(var r=0;r<n.length;++r){if(n[r].getAttribute("name")==o){i.push(n[r])}}return i}var loadXMLAsync=function(e,t,o,i,n,r,a){uriInfo=QZFL.util.URI(t);var l=/(qq|pengyou)\.com$/.test(uriInfo.host);if(!l){alert("跨域的资源访问禁止("+uriInfo.host+")");return}var s="http://"+/([a-z,A-Z,0-9,\-,_,\.]+\.com)$/i.exec(uriInfo.host)[1]+"/";var g=uriInfo.host;var c=s+(QZBlog.Logic.isInPengyou?"py_proxy.html":"proxy.html")
;if(s=="http://"+IMGCACHE_DOMAIN+"/"){c=window.location.protocol+"//"+IMGCACHE_DOMAIN+"/ac/qzone/"+(QZBlog.Logic.isInPengyou?"py_proxy.html":"proxy.html")}else if(s=="http://h5.qzone.qq.com/"){c=window.location.protocol+"//h5.qzone.qq.com/proxy/domain/qzs.qq.com/ac/qzone/proxy.html"}var u=document.getElementsByTagName("iframe");for(var d=0;d<u.length;d++){var f=false;try{f=u[d].src.indexOf(c)==0}catch(e){}if(f){if(!callBackHsmp[g]&&typeof callBackHsmp[g]!="undefined"){u[d].contentWindow.loadXMLAsync(e,t,o,i,n,r,a)}else{if(typeof callBackHsmp[g]=="undefined")callBackHsmp[g]=[];callBackHsmp[g][callBackHsmp[g].length]={callback:o,xID:e,xUrl:t,err_callback:i,nocache:n,data:r,returnType:a}}return}}if(!callBackHsmp[g]){callBackHsmp[g]=[{callback:o,xID:e,xUrl:t,err_callback:i,nocache:n,data:r,returnType:a}];createProxy(c)}};var callBackHsmp=[];var createProxy=function(e){var t=document.getElementsByTagName("iframe");for(var o=0;o<t.length;o++)if(t[o].src.indexOf(e)!=-1)return
;var o=document.createElement("iframe");var i=$("proxy");if(!i){document.body.insertBefore(o,null)}else{$("proxy").appendChild(o)}o.width=0;o.height=0;o.src=e;o=null};function doFill(e,t,o,i){o=typeof o=="undefined"?0:o;if(!t){return""}var n=/<%=@([#~&\w]+)%>/g;var r=!!t.xml,a="<%repeat_"+o+'\\s*match="([^"]+)"[^%]*%>',l="<%repeat_"+o+"[^>]*%>((.|\\n)+)<%_repeat_"+o+"%>",s=new RegExp(a),g=new RegExp(a,"g"),c=new RegExp(l),u=new RegExp("<%repeat_"+(o+1)+' match="([^"]+)"');if(e.match(s)==null){rt.error("没有找到节点<%repeat_"+o+"%>");return""}var d=e.match(g),f=0;for(var p=0;p<d.length;p++){var _=d[p];var h=_.replace(/^.*match=\"|\".*$/g,"");f=e.indexOf(_);var m=e.indexOf("<%_repeat_"+o+"%>",f);var v=e.substring(f,m+13);f+=_.length;var Q=e.substring(f,m);var B=r?t.selectNodes(h):objSelectNodes(t,h);var b=[];var Z=B.length;if(_.indexOf("repeat_num")>0){var L=_.replace(/^.*repeat_num=\"|\".*$/g,"");if(!isNaN(L)){Z=Math.min(Z,parseInt(L,10))}}for(var I=0;I<Z;I++){var E=B[I];var y=Q
;if(Q.match(u)!=null){y=doFill(Q,E,o+1,i)}var _=r?E.text:E;var U=y;if(0==I){var C=y.match(n);if(C==null){C=[]}else if(i){var N=[],M={};for(var S=0,T=C.length;S<T;S++){if(S==0||!M[C[S]]){N.push(C[S]);M[C[S]]=true}}C=N.sort().reverse()}}for(var A=0;A<C.length;A++){var O=C[A].replace(/\W/g,"");var P=r?B[I].getAttribute(O):B[I][O];if(P==null&&r&&B[I].selectSingleNode(O)!=null)P=B[I].selectSingleNode(O).text;if(P==null)P="";P=P.toString();var w=new RegExp(C[A],"g");U=U.replace(w,P.replace(/\$/g,"$$$$"))}b[I]=U}e=e.replace(v,QZONE.userAgent.ie?b.join(""):b.join("").replace(/\$/g,"$$$$"))}return e}function objSelectNodes(e,t){if(/^\//.test(t))t=t.substr(1);var o=t.split("/"),i=e[o.shift()];if(!i)return[];if(!i.sort)i=[i];if(o.length==0){return i}var n=o.join("/"),r=[];for(var a=0;a<i.length;a++){o=objSelectNodes(i[a],n);if(o&&o.length>0)r=r.concat(o)}return r}function objSelectSingleNode(e,t){var o=objSelectNodes(e,t);return o.length>=1?o[0]:null}String.prototype.trim=function(){
return trim(this)};String.prototype.ltrim=function(){return ltrim(this)};String.prototype.rtrim=function(){return rtrim(this)};String.prototype.toInnerHTML=function(){var e=this.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return QZONE.userAgent.ie?e.replace(/&apos;/g,"&#39;"):e};String.prototype.toRealStr=function(){return this.replace(/&quot;/g,'"').replace(/(?:&#39;)|(?:&apos;)/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&#92;/g,"\\")};String.prototype.convCR=function(e){return!!e?this.replace(/<br \/>/g,"\n"):this.replace(/\n/g,"<br />")};String.prototype.convSP=function(e){return!!e?this.replace(/&nbsp;/g," "):this.replace(/\x20\x20/g,"&nbsp;&nbsp;")};String.prototype.convHeaderSP=function(){return this.replace(/\n\x20(^\x20)*/gi,"\n&nbsp;$1")};String.prototype.getRealLength=function(){return this.replace(/[^\x00-\xff]|\n/g,"hh").length};String.prototype.URLencode=function(){
return URIencode(this)};String.prototype.getUrlParamValue=function(e){var t=new RegExp("(\\?|#|&)"+e+"=([^&#]*)(&|#|$)");var o=this.match(t);return!o?"":o[2]};String.prototype.cutWord=function(e){var t=this.toRealStr();if(t.getRealLength()<=e||e<=0)return t.toInnerHTML();var o="";var i=Math.floor(e/2);while(1){o=t.substr(0,i);if(o.getRealLength()<e-1){i=i+Math.floor((e-o.getRealLength())/2)}else if(o.getRealLength()>e){i=i-Math.floor((o.getRealLength()-e)/2)}else if(o.getRealLength()==e){break}else{if(i<t.length&&!QZBlog.Util.isMultipleByte(t.charCodeAt(i))){o=t.substr(0,i+1)}break}}return o.toInnerHTML()};function getParameter(e){var t=new RegExp("(\\?|#|&)"+e+"=([^&#]*)(&|#|$)");var o=location.href.match(t);return!o?"":o[2]}function getAuthor(e,t,o){e=parseInt(e,10);o=String(o||QZBlog.Util.getLoginUin());var i=false;i=t&&QZONE.FP.isAlphaUser();i=i||parseInt(o.substring(o.length-2),10)<e;return i}function BlogXMLselectSingleNode(e,t){var o=BlogXMLselectNodes(e,t);if(!o||o.length<1){
return null}return o[0]}function BlogXMLselectNodes(e,t){var o=new XPathEvaluator;var i=o.createNSResolver(e.ownerDocument==null?e.documentElement:e.ownerDocument.documentElement);var n=o.evaluate(t,e,i,0,null);var r=[];var a;while(a=n.iterateNext()){r.push(a)}return r}function XMLSelectNodes(e,t){if(QZONE.userAgent.ie){return e.selectNodes(t)}else{return BlogXMLselectNodes(e,t)}}function XMLselectSingleNode(e,t){if(QZONE.userAgent.ie){return e.selectSingleNode(t)}else{return BlogXMLselectSingleNode(e,t)}}function isXMLDoc(e){try{XMLselectSingleNode(e,"/");return true}catch(e){return false}}function getXMLNodeText(e){if(!e){return null}if(typeof e.innerText!="undefined"){return e.innerText}else if(typeof e.textContent!="undefined"){return e.textContent}return e.text}function isValidUin(e){if(typeof e=="string"){if(e.length>15){return true}}e=parseInt(e,10);if(!isNaN(e)&&/\d{5,10}/.test(e)){return true}return false}var QZBlog={Logic:{
isInPengyou:!!/pengyou\.com$/.test(location.hostname),isInV6:true,isSeoPage:!QZONE.FP.getCurrentAppWindow(),isBlogPage:location.host.toLowerCase()=="blog.qq.com",qqDomainFilter:function(e){if(/^http\:\/\/[\w|\.]+\.qq\.com\//i.test(e)||/^http\:\/\/[\w|\.]+\.pengyou\.com\//i.test(e)){return e}return""}},Util:{}};QZBlog.CGI_URL=function(){var e=CGI_BLOG_DOMAIN;var t="";var o=QZONE.FP._t.g_BLOG_LOCATION_PREFIX||"b";var i=QZONE.FP._t.g_BLOG_LOCATION_LOGIN_PREFIX||"b";var n={msgboard:"/cgi-bin/new/",private:"/cgi-bin/privateblog/",draft:"/cgi-bin/draft/",recycle:"/cgi-bin/recyclebin/",ugc:"/cgi-bin/ugc/",operation:"/cgi-bin/operation/",default:"/cgi-bin/blognew/"};var r={b:CGI_BLOG_DOMAIN,bn:QZBlog.Logic.isInPengyou?"%s.pengyou.com":"%s.qzone.qq.com",loginUser2Bn:QZBlog.Logic.isInPengyou?"%l.pengyou.com":"%l.qzone.qq.com"};var a={
b:",blog_get_blogbitmap,blog_recommend_self,blog_one_count,blog_report_audit,blog_get_readerlist,"+"blog_get_count_mutiuin,blog_get_related,blog_set_bitmap,blog_hide_readerlist,blog_get_qqnews,blog_fetch_source,"+"blog_get_taglists,blog_output_tagpagelist,blog_get_setting,set_user_info,get_winninglist,blog_get_spread,readzone_add_unconcern,"+"readzone_get_concern,readzone_get_friendlist,readzone_get_newnum,readzone_get_data,readzone_get_replylist,readzone_get_titlelist_mix,"+"readzone_get_titlelist_single,readzone_get_titletoppage,readzone_set_concern,url_check,ugcblog_get_update_num,"+"ugcblog_clear_update_num,operation_get_recommend,blog_get_unverify,",
bn:",add_comment,get_comment_list,blog_add_comment,blog_add,add_blog,ablog_add,ablog_get_list,ablog_recommit,"+"ablog_del,blog_del_category,blog_del_comment,del_comment,del_blog,blog_del_comment_ic,blog_del_data,blog_batch_del_data,"+"blog_get_category,blog_get_data,get_blog,blog_get_specialtitle,blog_get_titlelist,blog_modify,mod_blog,blog_modify_category,"+"blog_set_top,mod_blog_effect,add_reply,blog_reply_comment,blog_recommend_self,blog_batch_del_comment,"+"batch_del_comment,mod_blog_cate,blog_get_abstract,blog_get_abstract2,get_abs,blog_del_replycomment,del_reply,"+"blog_modify_right,blog_add_category,op_cate,blog_batch_modify_category,blog_batch_modify_right,mod_blog_right,"+"blog_modify_img,blog_output_data,blog_output_titlelist,blog_output_titlelist2,blog_output_toppage,blog_pass_unverify,"+"blog_modify_tag,blog_generate_feeds,blog_get_media,blog_to_tweet,blogimg_to_tweet,blog_get_datenum,"+"draft_output_manual_data,draft_output_manual_list,draft_output_manual_list2,draft_del_manual_data,draft_get_manual_data,"+"draft_get_manual_list,draft_set_manual_data,draft_add_blog,draft_modify_blog,draft_get_auto_data,draft_set_auto_data,"+"draft_del_auto_data,draft_auto2manual,draft_output_data,draft_del_data,draft_get_data,draft_output_list,draft_set_data,"+"draft_to_blog,privateblog_add,privateblog_del_data,privateblog_get_data,privateblog_get_specialtitle,privateblog_get_titlelist,"+"privateblog_modify,privateblog_output_data,privateblog_pub2prv,privateblog_prv2pub,privateblog_del_comment,"+"privateblog_batch_prv2pub,privateblog_batch_pub2prv,pwd2c_query_iframe,recyclebin_del,recyclebin_get_list,recyclebin_recover_blog,"+"recyclebin_switch,ugcblog_del_data,ugcblog_get_list_async,",
loginUser2Bn:",blog_quote,quote_blog,"};return{get:function(e,t){var o=location.protocol==="https:"?"https://"+(parent.g_cgidomain||"h5")+".qzone.qq.com/proxy/domain/":"http://";var i=o+this.getDispatchDomain(e);i+=n[t]?n[t]:n["default"];i+=e;return i},getDispatchDomain:function(n){var l=e;for(var s in a){if(a[s].indexOf(","+n+",")>=0&&r[s]){var g=i+(t.length>0?"."+t:"");var c=o+(t.length>0?"."+t:"");l=r[s].replace("%l",g).replace("%s",c);break}}return l},getRouterCgiUrl:function(e){if(!e){e=[QZBlog.Logic.SpaceHostInfo.getLoginUin(),QZBlog.Logic.SpaceHostInfo.getUin()]}return"http://"+CGI_BLOG_R_DOMAIN+"/cgi-bin/blognew/blog_get_route?fupdate=1&g_tk="+QZBlog.Util.getToken()+"&uinlist="+e.join(",")},setLocatePrefix:function(e){QZONE.FP._t.g_BLOG_LOCATION_PREFIX=e;o=e},setLoginLocatePrefix:function(e){QZONE.FP._t.g_BLOG_LOCATION_LOGIN_PREFIX=e;i=e}}}();if(!parent.g_oBlogPortraitList){parent.g_oBlogPortraitList={}}QZBlog.Util.PortraitManager={portraitSeed:"",getPortraitUrl:function(e,t){
t=parseInt(t);var o=/[A-Z|a-z]/g;var i=o.exec(e);if(!i){return"//qlogo"+(e%4+1)+".store.qq.com/qzone/"+e+"/"+e+"/"+t}else if(typeof e=="string"){return QZONE.FP.getPURL(e,t)}else{return parent.DEFAULT_USER_PORTRAIT}}};QZBlog.Logic.SpaceHostInfo={_strSignature:null,_bProcessing:false,hasPrivatePwd:function(){return QZBlog.Util.getBitMapFlag(44)==1},hasPrivatePwdVerified:function(){return!(QZFL.cookie.get("prvk")==""||QZFL.cookie.get("prvk")==null)},needVerifyPrivate:function(){return QZBlog.Util.getBitMapFlag(45)==1},isAlphaUser:function(){return QZBlog.Util.getBitMapFlag(58)==1},isFamousUser:function(){return QZBlog.Util.getBitMapFlag(7)==1},isBizUser:function(){return QZBlog.Util.getBitMapFlag(5)==1},isInteractiveUser:function(){return QZBlog.Util.getBitMapFlag(52)==1},isVipUser:function(){return QZBlog.Util.getBitMapFlag(27)==1},getSpaceUrl:function(){return QZBlog.Util.getSpaceUrl(this.getUin())},getLoginUserSpaceUrl:function(){return QZBlog.Util.getSpaceUrl(this.getLoginUin())},
getLoginUin:function(){return QZBlog.Util.getLoginUin()},isValidLoginUin:function(){return QZBlog.Logic.isInPengyou?!!QZBlog.Util.getLoginUin():QZBlog.Util.getLoginUin()>1e4},isOwnerMode:function(){return this.getLoginUin()==this.getUin()},getVipLevel:function(){var e=parent.QZONE.dataCenter.get("yellowDiamondInfo");if(!e){return-1}return e.level},getUin:function(){return QZBlog.Util.getSpaceUin()},getNickname:function(){return QZBlog.Util.getNickname()},checkAuthorization:function(){return!!(QZBlog.Util.getBitMapFlag(11)+QZBlog.Util.getBitMapFlag(10)+QZBlog.Util.getBitMapFlag(9))},checkReplyAuthorization:function(){return!!(QZBlog.Util.getBitMapFlag(14)+QZBlog.Util.getBitMapFlag(13)+QZBlog.Util.getBitMapFlag(12))},getListViewMode:function(e){if(typeof parent.blogFixedViewMode!="undefined"){if(!!e&&typeof e=="function"){e()}return parent.blogFixedViewMode}if(QZBlog.Logic.SpaceHostInfo.isOwnerMode()&&!!parent.g_oBlogSettingInfoMgr){
if(!!parent.g_oBlogSettingInfoMgr.isSettingInfoReady(this.getUin())){if(!!e&&typeof e=="function")e();return parent.g_oBlogSettingInfoMgr.getListMode(this.getUin())}if(!!e&&typeof e=="function"){QZBlog.Util.getSubLoginBitMapFlag(function(t,o){if(!t)return;parent.g_oBlogSettingInfoMgr.createSettingInfo(QZBlog.Logic.SpaceHostInfo.getLoginUin(),t);e()},1)}}else{if(!!parent.QZONE.dataCenter.get("QZBlogListMode_"+QZBlog.Logic.SpaceHostInfo.getUin())){if(!!e&&typeof e=="function")e();return parent.QZONE.dataCenter.get("QZBlogListMode_"+QZBlog.Logic.SpaceHostInfo.getUin())}if(!!e&&typeof e=="function"){var t=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("blog_get_blogbitmap"),data:{hostuin:QZBlog.Logic.SpaceHostInfo.getUin(),fupdate:1},method:"get",uniqueCGI:true});t.onSuccess=function(t){var o=t.data.hostflag.substr(0,8);var i=parseInt(o,16)>>58-32-1&1
;parent.QZONE.dataCenter.save("QZBlogListMode_"+QZBlog.Logic.SpaceHostInfo.getUin(),!i?parent.BlogListViewType["CLASSIC"]:parent.BlogListViewType["DIGEST"]);e()};t.send()}}return-1}};QZBlog.Logic.jumpToBaseListCGIUrl=function(){location.href="//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V6_PATH+"/bloglist.html"};QZBlog.Logic.jumpToList=function(e){QZBlog.Router.redirectTo("bloglist","catalog="+(e||""))};if(!parent.g_nBlogFirstPageRandSeed){parent.g_nBlogFirstPageRandSeed=Math.random()}QZBlog.Util.ImageManager={_nCleanTime:3*60*1e3,_imgArr:[],_bCleaning:false,PRELOAD_URLS:["/ac/b.gif",DEFAULT_PORTRAIT_IMGURL,LOADING_GIF],_removeImage:function(e){if(!!this._imgArr[e]){delete this._imgArr[e];this._imgArr[e]=null;return true}return false},loadObjectImage:function(e,t,o){if(!t||!t.tagName||t.tagName.toLowerCase()!="img"){return}this.loadImage(e,true,function(){t.src=e;if(!!o){o()}})},loadImage:function(e,t,o){if(!e){return}if(this._bCleaning==true){var i=200;if(this._imgArr[e]){
i=Math.max(parseInt(this._imgArr[e].getAttribute("timeout"),10)-50,0);this._imgArr[e].setAttribute("timeout",i)}setTimeout(QZONE.event.bind(this,this.loadImage,e,t,o),i);return}if(t!=false){t=true}if(!!this._imgArr[e]){if(this._imgArr[e].getAttribute("loaded")==1&&!!o){o()}else if(this._imgArr[e].getAttribute("loaded")==null){var i=Math.max(parseInt(this._imgArr[e].getAttribute("timeout"),10)-100,0);this._imgArr[e].setAttribute("timeout",i);setTimeout(QZONE.event.bind(this,this.loadImage,e,t,o),i)}return}var n=new Image;n.setAttribute("removeable",t);n.onload=function(){this.onerror=this.onload=null;this.setAttribute("loaded",1);if(!!o){o()}};n.onerror=function(){this.onerror=this.onload=null;this.setAttribute("loaded",0)};this._imgArr[e]=n;this._imgArr[e].src=e;this._imgArr[e].setAttribute("timeout",500)},_initMgr:function(){for(var e in this.PRELOAD_URLS){this.loadImage(this.PRELOAD_URLS[e],false,null)}setInterval(QZONE.event.bind(this,function(){this._bCleaning=true
;for(var e in this._imgArr){if(!this._imgArr[e]||typeof this._imgArr[e].getAttribute("loaded")=="undefined"||this._imgArr[e].getAttribute("removeable")==false){continue}if(this._removeImage(this._imgArr.src)==false){console.log("无法删除QZBlog.Util.ImageManager的缓存："+this._imgArr.src)}}this._bCleaning=false}),this._nCleanTime)}()};QZBlog.Util.scaleRegion=function(e,t,o,i){if(!e||!t){return null}var n,r,a=true;if(o&&i&&e>o&&t>i){if(e/t>o/i){r=o*t/e;n=o}else{n=i*e/t;r=i}}else if(o&&e>o){r=o*t/e;n=o}else if(i&&t>i){n=i*e/t;r=i}else{a=false}if(a){return{width:n,height:r}}return null};QZBlog.Util.adjustImageSize=function(e,t,o,i,n){var r=new Image;r.onload=function(){var a,l,s=e.style.width?parseInt(e.style.width,10):e.width,g=e.style.height?parseInt(e.style.height,10):e.height,c=r.width,u=r.height;c=s||c;u=g||u;var d=QZBlog.Util.scaleRegion(c,u,t,o);if(d){e.style.width=parseInt(d.width,10)+"px";e.style.height=parseInt(d.height,10)+"px";if(n){e.style.cursor="pointer";e.title="点击预览原图"
;e.onclick=function(){window.open(e.src)}}}i&&i(d)};r.src=e.src};QZBlog.Util.createTemplate=function(){if(!$("xmpTemplate"))return;var e=QZONE.userAgent.opera?$("xmpTemplate").innerText:$("xmpTemplate").innerHTML;var t=/\{(\w+)\x20begin\}((.|\n|\r)+?)\{end\}/gi;var o;while((o=t.exec(e))!=null){if(o.length<3)continue;parent.g_hsBlogTemplate[o[1]]=o[2]}$("xmpTemplate").innerHTML=$("xmpTemplate").innerText=""};if(typeof parent.g_hsBlogTemplate=="undefined"){parent.g_hsBlogTemplate={}}QZBlog.Logic.TCISDClick=function(){var e={"/BlogList":"BlogList","/BlogEditer":"BlogEditer","/BlogContent":"BlogContent","/formatdiary":"formatdiary"};return function(t,o,i,n){if(QZBlog.Logic.isInPengyou||!o){return}var r=e[o]?e[o]+"."+t:t;i=i||"blog.qzone.qq.com";console.log("TCISD:",r,i,o);try{QZONE.FP._t.TCISD.hotClick(r,i,o)}catch(e){console.log(e)}}}();QZBlog.Logic.TCISDClick.batchBind=function(e,t){t=QZFL.object.extend({eventType:"mousedown",url:null,domain:null,container:document},t||{});if(!t.url){
throw"TCISDClick URL REQUIRED"}var o={};QZFL.each(e,function(e,i){o[i]=function(){QZBlog.Logic.TCISDClick(e,t.url,t.domain)}});QZBlog.Logic.batchDelegate(o,t.container,t.eventType,true)};QZBlog.Logic.batchDelegate=function(){var e=function(e){return e&&e.tagName=="A"&&((e.href||"").indexOf("http://")==0||(e.href||"").indexOf("https://")==0)};var t=function(e,t){var o;$e(t).each(function(t){if(!o&&(t==e||QZFL.dom.isAncestor(t,e))){o=t;return false}});return o};return function(o,i,n,r){n=n||"click";i=i||document;QZFL.each(o,function(o,a){QZFL.event.delegate(i,a,n,function(i){var l=QZFL.event.getButton(i);var s=QZFL.event.getTarget(i);s=t(s,a);if(s){if(n=="click"&&l!=0&&e(s)){}else{o(s);if(s.tagName=="A"&&!r){QZFL.event.preventDefault(i)}}}})})}}();QZBlog.Util.Statistic=function(){var e=5,t=175,o=5,i=6,n=7,r=[],a={};var l={showlist:"/index/blog/list.php",readblog:"/index/blog/show.php",neweditblog:"/index/blog/post.php",editblog:"/index/blog/edit.php",
showprivatelist:"/index/blog/secret.php",readprivateblog:"/index/blog/secretshow.php",showdraftlist:"/index/blog/draft.php",editdraft:"/index/blog/editdraft.php",previewblog:"/index/blog/dopreview.php"};var s=function(){var e=r.length-1;while(e>=0){if(r[e].ready){delete r[e];r=r.slice(0,e).concat(r.slice(e+1));break}--e}};var g=function(t,o){var i=null;var n=-1;for(var a=0;a<r.length;++a){if(r[a].ready){r[a].ready=false;i=r[a];n=a;break}}if(n<0){n=r.length;i=r[r.length]=new Image;i.ready=false}i.onload=i.onerror=function(){i.onload=null;i.onerror=null;i.ready=true;if(r.length>e){s()}};if(o){setTimeout(function(){i.src=t},o)}else{i.src=t}};var c=function(e,t){if(t=="rizhi.qzone.qq.com"&&Math.ceil(Math.random()*100)!=50){return}var o="";if(!!t){o=t}else{if(QZBlog.Logic.SpaceHostInfo.isBizUser()){o="biz.qzone.qq.com"}else if(QZBlog.Logic.SpaceHostInfo.isFamousUser()){o="star.qzone.qq.com"}else{o="blog.qzone.qq.com"}}if(QZBlog.Logic.isInPengyou){o="xiaoyou.qq.com"}
if(QZBlog.Logic.isInPengyou){if(!!l[e]){e=l[e]}}var i=["dm="+o,"url=/"+encodeURIComponent(e)];var n=/https?:\/\/(\w+(\.\w+)+)(\/[^?#]*)?/;var r=document.referrer.match(n);if(!!r){var a="";if(r.length>1){var s=r[1];var c=s.match(/(\d{5,10})\.(\w+(\.\w+)+)(\/[^?#]*)?/);if(c){s="user.qzone.qq.com";a=c[1]}i.push("rdm="+s)}if(r.length>3){i.push("rurl="+encodeURIComponent((a.length>0?"/"+a:"")+r[3]))}}var u=QZONE.cookie.get("pvid");if(!u){u=Math.round(Math.random()*2147483647)*(new Date).getUTCMilliseconds()%1e10;var d=10*12*30*24*3600*1e3;QZONE.cookie.set("pvid",u,d,"qq.com")}i.push("pvid="+u);g("//pingfore.qq.com/pingd?scr=-&scl=-&lang=-&java=1&cc=-&pf=-&tz=-8&ct=-&vs=3.3&tt=-&"+i.join("&")+"&sds="+Math.random(),1e3);console.log("sendPV:",e,":",t)};var u=function(){if(QZBlog.Logic.SpaceHostInfo.isFamousUser()){g("//h5.qzone.qq.com/proxy/domain/p1.qzone.qq.com/fcg-bin/fcg_page_pu_view?id="+QZBlog.Logic.SpaceHostInfo.getUin()+"&type=2&info=2%2C0&r="+Math.random(),1e3)
}else if(QZBlog.Logic.SpaceHostInfo.isBizUser()){g("//h5.qzone.qq.com/proxy/domain/p1.qzone.qq.com/fcg-bin/fcg_page_pu_view?id="+QZBlog.Logic.SpaceHostInfo.getUin()+"&type=1&info=2%2C0&r="+Math.random(),1e3)}};var d=function(e){};var f=function(e,t){if(typeof e=="number"&&e>=1){a[e]=t||(new Date).getTime();return true}return false};var p=function(e,o,r){if(o!=i&&Math.ceil(Math.random()*100)!=50){parent.bcSpeedBasePoint=null;parent.blSpeedBasePoint=null;return false}if(!window.blogSpeedBasePoint){return false}var l=window.blogSpeedBasePoint;if(o==n){if(!parent.bcSpeedBasePoint){return false}l=new Date(parent.bcSpeedBasePoint).getTime()}f(1,l);var s="//isdspeed.qq.com/cgi-bin/r.cgi?flag1="+t+"&flag2="+e+"&flag3="+o+"&flag4=0"+"&flag5=0"+"&uin="+QZBlog.Logic.SpaceHostInfo.getUin()+"&hh="+Math.random();for(var c in a){if(a[c]){s+="&"+c+"="+(a[c]-l)}}console.log("SpeedStat:",s);r=r==undefined?1e3:parseInt(r,10)||0;return g(s,r)};var _=function(){
window.blogSpeedBasePoint=(new Date).getTime();a=[]};var h=function(e,o,i){if(!o||!i){console.log("需要指定测速页面，和测速项id");return}var n="//isdspeed.qq.com/cgi-bin/r.cgi?flag1="+t+"&flag2="+o+"&flag3="+i+"&flag4=0"+"&flag5=0"+"&uin="+QZBlog.Logic.SpaceHostInfo.getUin()+"&hh="+Math.random();for(var r=0,a=e.length;r<a;r++){n+="&"+(r+1)+"="+(e[r]-e[0])}g(n)};return{sendPV:c,sendUPV:u,sendSpeedStat:h,addSpeedPoint:f,resetSpeedPoint:_,sendSpeedStatistic:p,sendRetCodeStatic:d}}();QZBlog.Util.getToken=function(){return QZONE.FP.getACSRFToken()};QZBlog.Util.getCurrentAppWindow=function(){return QZONE.FP.getCurrentAppWindow()||(!frameElement?parent:null)};QZBlog.Util.getBitMapFlag=function(e){return QZONE.FP.getBitMapFlag(e)};QZBlog.Util.setBitMapFlag=function(e,t){QZONE.FP.setBitMapFlag(e,t)};QZBlog.Util.getLoginBitMap=function(e){return QZONE.FP.getLoginBitmap(e)};QZBlog.Util.getNickname=function(){return QZONE.FP.getNickname()};QZBlog.Util.getSpaceUin=function(){
return QZONE.FP.getQzoneConfig().ownerUin};QZBlog.Util.getPengyouDecodeUin=function(){return QZONE.FP._t.CUSER?QZONE.FP._t.CUSER.get("qq"):""};QZBlog.Util.getLoginUin=function(){return QZONE.FP.getQzoneConfig().loginUin};QZBlog.Util.getStyleID=function(){return QZONE.FP.getQzoneConfig().styleId};QZBlog.Util.isOldXWMode=function(){var e=false;try{e=!!QZONE.FP._t.QZONE.dressDataCenter.isOldXWMode()}catch(e){}return e};QZBlog.Util.isSmallMode=function(){return!QZONE.FP.getQzoneConfig().full};QZBlog.Util.isWideMode=function(){if(!!parent.g_bFromInfoCenter){return false}return QZONE.FP.getQzoneConfig().wide};QZBlog.Util.getSpaceMode=function(){if(QZBlog.Util.isFreeMode()){return 5}if(!!parent.g_Izone){return 6}if(!!parent.g_bFromInfoCenter){return 4}if(QZBlog.Util.isWideMode()){return 1}if(QZBlog.Util.isSmallMode()){return 3}return 2};QZBlog.Util.isFreeMode=function(){return!!parent.g_OFPLite};QZBlog.Util.isLiteMode=function(){return QZONE.FP.getQzoneConfig().isLite}
;QZBlog.Util.getFreeModeMaxMediaWidth=function(){if(!QZBlog.Util.isFreeMode()){return-1}return Math.max(0,QZBlog.Util.getFrameWidth()-20)};QZBlog.Util.getFrameWidth=function(){var e=window.frameElement||parent.document.getElementById(FRAME_ID)||parent.document.getElementById(MSG_FRAME_ID);return QZONE.dom.getPosition(e)["width"]};QZBlog.Util.getFrameHeight=function(){var e=window.frameElement||parent.document.getElementById(FRAME_ID)||parent.document.getElementById(MSG_FRAME_ID);return QZONE.dom.getPosition(e)["height"]};QZBlog.Util.showLoginBox=function(e,t,o){QZONE.FP.showLoginBox(e,t,"",{mode:!!o})};QZBlog.Util.hideMsgbox=function(){QZONE.FP.hideMsgbox()};QZBlog.Util.showMsgbox=function(e,t,o){if(t==1){t=5}parent.QZONE.FP.showMsgbox(e,t,o)};QZBlog.Util.appendPopupFn=function(e){QZONE.FP.appendPopupFn(e)};QZBlog.Util.popupDialog=function(e,t,o,i){QZONE.FP.popupDialog(e,t,o,i)};QZBlog.Util.closePopup=function(){QZONE.FP.closePopup()};QZBlog.Util.setScrollTop=function(e){
QZONE.FP.setScrollTop(e)};QZBlog.Util.getScrollTop=function(){return QZONE.FP.getScrollTop()};QZBlog.Util.toApp=function(e){QZONE.FP.toApp(e)};QZBlog.Util.getPortraitList=function(e,t){return QZONE.FP.getPortraitList(e,t,{size:100,needScore:1})};QZBlog.Util.regClickStream=function(e,t){};QZBlog.Util.getLoginUserBitMap=function(e,t){if(!QZBlog.Logic.SpaceHostInfo.isValidLoginUin()){return}QZONE.FP.getLoginUserBitMap(e,t)};QZBlog.Util.jsonToString=function(e){switch(typeof e){case"string":return'"'+e.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+e.map(QZBlog.Util.jsonToString).join(",")+"]";case"object":if(e instanceof Array){var t=[];var o=e.length;for(var i=0;i<o;i++){t.push(QZBlog.Util.jsonToString(e[i]))}return"["+t.join(",")+"]"}else if(e===null){return"null"}else{var t=[];for(var n in e){t.push(QZBlog.Util.jsonToString(n)+":"+QZBlog.Util.jsonToString(e[n]))}return"{"+t.join(",")+"}"}case"number":return e;case true:case false:return e}}
;QZBlog.Util.getLoginVIPLevel=function(){return QZONE.FP.getLoginBitmap(18,4)};QZBlog.Util.getLoginIsVIP=function(){return QZONE.FP.getLoginBitmap(27)};QZBlog.Util.isLoginVIPExpress=function(){return QZONE.FP.getLoginBitmap(17)};QZBlog.Util.getSubLoginBitMapFlag=function(e,t){if(!QZBlog.Logic.SpaceHostInfo.isValidLoginUin()){return}QZONE.FP.getSecondaryBitMapFlag(e,t,null,QZBlog.Logic.SpaceHostInfo.getLoginUin())};QZBlog.Util.CreditLevel={A:0,B_FIRST:1,B_SECOND:2,B_THIRD:3,C_FIRST:4,C_SECOND:5,C_THIRD:6,D:7};QZBlog.Util.getLoginUserCreditLevel=function(){var e=QZONE.FP.getCrediteLevel(QZBlog.Logic.SpaceHostInfo.isOwnerMode()?true:false);switch(e){case 0:e=QZBlog.Util.CreditLevel["B_THIRD"];break;case 1:e=QZBlog.Util.CreditLevel["A"];break;case 2:e=QZBlog.Util.CreditLevel["B_FIRST"];break;case 3:e=QZBlog.Util.CreditLevel["B_SECOND"];break;case 4:e=QZBlog.Util.CreditLevel["C_FIRST"];break;case 5:e=QZBlog.Util.CreditLevel["C_SECOND"];break;case 6:e=QZBlog.Util.CreditLevel["C_THIRD"];break
;case 7:e=QZBlog.Util.CreditLevel["D"];break}return e};QZBlog.Util.getCurrentSpaceUserCreditLevel=function(){var e=QZONE.FP.getCrediteLevel(false);switch(e){case 0:e=QZBlog.Util.CreditLevel["B_THIRD"];break;case 1:e=QZBlog.Util.CreditLevel["A"];break;case 2:e=QZBlog.Util.CreditLevel["B_FIRST"];break;case 3:e=QZBlog.Util.CreditLevel["B_SECOND"];break;case 4:e=QZBlog.Util.CreditLevel["C_FIRST"];break;case 5:e=QZBlog.Util.CreditLevel["C_SECOND"];break;case 6:e=QZBlog.Util.CreditLevel["C_THIRD"];break;case 7:e=QZBlog.Util.CreditLevel["D"];break}return e};QZBlog.Util.getSecureSettingInfo=function(e,t){var o=this;if(!o._oSecureInfo){if(o._nSecureCalledCnt>=1){if(typeof t=="function"){t(0)}return}o._nSecureCalledCnt=o._nSecureCalledCnt?o._nSecureCalledCnt+1:1;var i=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("blog_get_rz_setting"),data:{uin:QZBlog.Logic.SpaceHostInfo.getUin(),fupdate:1},method:"get",uniqueCGI:true,isSilenderMode:true});i.onSuccess=function(i){
o._oSecureInfo=i.data.web_sec;o.getSecureSettingInfo(e,t)};i.onError=function(){if(typeof t=="function"){t(0)}};i.send();return}if(typeof t=="function"){o._hsKeyWords={writeBlogEntry:"block_write_blog",writeBlogError:"disable_button_on_fail",writeBlogHint:"suggest_save_on_write",forbidCommentAndReply:"block_comment_and_reply",disable_read_counter:"disable_read_counter"};t(o._oSecureInfo[o._hsKeyWords[e]])}};QZBlog.Util.getSignature=function(e,t){if(parent.spaceOwnerSignature!==undefined){t(parent.spaceOwnerSignature);return}var o=new QZBlog.Util.NetRequest({url:"http://"+SPACE_MAIN_READ_DOMAIN+"/cgi-bin/user/cgi_get_signature",data:{huin:e||QZBlog.Logic.SpaceHostInfo.getUin(),fuin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),notubb:1,fupdate:1},method:"get",uniqueCGI:true,isSilenderMode:true});o.onSuccess=function(e){if(e.code==0){parent.spaceOwnerSignature=e.data.sign;t(e.data.sign)}};o.send()};QZBlog.Util.VerifycodeType={NEEDCODE:0,ERRCODE:1,IPC_CHECK:2,NORMALCODE:3}
;QZBlog.Util.MSG_LIFTTIME={HIGH:3e3,MIDDLE:1500,LOW:1e3,INFINITE:0};QZBlog.Util.DumpMsgFunc=function(){QZBlog.Util.showMsgbox("服务器繁忙，请稍候重试",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE)};QZBlog.Util.showSpaceCloseHintDlg=function(){var e={src:"/qzone/newblog/v5/dialog/space_close_hint.html"};QZBlog.Util.popupDialog("温馨提示",e,360,110)};QZBlog.Util.showVerifycodeDlg=function(e,t){var o='<iframe frameborder="no" id="verifycodeFrame" style="width:100%;height:160px;" src="/qzone/verifycode.html?imgcode='+BLOG_VERIFY_CODE+"&type="+e+'"></iframe>';try{if(QZONE.FP.popupDialog._cpp){QZBlog.Util.closePopup()}}catch(e){}parent.window.setTimeout(function(){parent.popupCallback=function(e){if(!!e){t(e)}};QZONE.FP.popupDialog("请输入验证码",o,270,160)},300)};QZBlog.Util.addDataToUri=function(e,t,o,i){i=i?i.toLowerCase():"get";var n=new RegExp("([&|?]"+e+"=)([^&]*)");if(n.test(o)){return o.replace(n,function(){return arguments[1]+t})}else{var r=i=="post"?"&":o.indexOf("?")>=0?"&":"?";return o+r+e+"="+t}}
;QZBlog.Util.BlogNetProcessor=function(){this._DEFAULT_TYPE="get";this._DEFAULT_CHARSET="GB2312";this._DEFAULT_CALLBACK_NAME="_Callback";this._DEFAULT_POSTTYPE="XML";this.verifyHandler=null;this.loginHandler=null;this.rightHandler=null;this.forbiddenHandler=null;this.alertHandler=null;this.confirmHandler=null;this.spaceCloseHandler=null;this.pwdHandler=null;this._bProcessing=false;this._nProcessingTimer=-1;this._type=this._DEFAULT_TYPE;this._url="";this._charset=this._DEFAULT_CHARSET;this._silentMode=true;this._succHandler=QZONE.emptyFn;this._errHandler=QZONE.emptyFn;this._callbackName=this._DEFAULT_CALLBACK_NAME;this._postType=this._DEFAULT_POSTTYPE;this._nStartTime=null;this._defaultErrHandler=function(){if(!this._silentMode){QZBlog.Util.DumpMsgFunc()}if(!!this._errHandler){this._errHandler()}var e=(new Date).getTime()-this._nStartTime;var t="network error";this.sendStatCode(this._url,t,e);this.close()};this.sendStatCode=function(e,t,o){var i=function(){try{stat_send_retcode(e,t,o)
}catch(e){}};if(typeof stat_send_retcode!="function"){QZFL.imports("http://"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/script/retcode_stat.js",i,"utf-8")}else{i()}};this._commonErrTypeHandler=function(e,t){switch(e){case"pwd2 expired":QZBlog.Util.clearPwd2Sig();if(this.pwdHandler){this.pwdHandler();break};case"login":case"not login":if(this.loginHandler){this.loginHandler();break}case"ipc_check":if(this.verifyHandler){QZBlog.Util.showVerifycodeDlg(QZBlog.Util.VerifycodeType.IPC_CHECK,QZONE.event.bind(this,this.verifyHandler));break}case"verify code":if(this.verifyHandler){QZBlog.Util.showVerifycodeDlg(QZBlog.Util.VerifycodeType.ERRCODE,QZONE.event.bind(this,this.verifyHandler));break}case"verify":case"need_verify":if(this.verifyHandler){QZBlog.Util.showVerifycodeDlg(QZBlog.Util.VerifycodeType.NEEDCODE,QZONE.event.bind(this,this.verifyHandler));break}case"alert":if(this.alertHandler){this.alertHandler(t);break}case"confirm":if(this.confirmHandler){this.confirmHandler(t);break}
case"forbidden":if(this.forbiddenHandler){this.forbiddenHandler();break}case"spaceclose":if(this.spaceCloseHandler){this.spaceCloseHandler();break}default:{if(!this._silentMode){if(!t){QZBlog.Util.DumpMsgFunc()}else{QZBlog.Util.showMsgbox(t,1,QZBlog.Util.MSG_LIFTTIME.MIDDLE)}}}}};this._simpleXMLErrHandler=function(e){var t=XMLselectSingleNode(e,"/error");if(!t){return}this._commonErrTypeHandler(t.getAttribute("type"),getXMLNodeText(t))};this._simpleJsonErrHandler=function(e){if(!e.error){return}this._commonErrTypeHandler(e.error.type,e.error.msg)};this._callback=function(e){if(!this._silentMode){QZBlog.Util.hideMsgbox()}if(!e){QZBlog.Util.showMsgbox("暂时无法获取服务器数据",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);return}var t=(new Date).getTime()-this._nStartTime;var o="";if(isXMLDoc(e)&&XMLselectSingleNode(e,"/error")){o=XMLselectSingleNode(e,"/error").getAttribute("type");this._simpleXMLErrHandler(e);if(this._errHandler){this._errHandler.apply(null,arguments)}}else if(e.error){o=e.error.type
;this._simpleJsonErrHandler(e);if(this._errHandler){this._errHandler.apply(null,arguments)}}else{o="success";var i=["blog_add","blog_del_data","blog_modify","blog_set_top","blog_modify_right","blog_add_category","blog_batch_modify_category","blog_batch_modify_right","draft_add_blog","draft_modify_blog","privateblog_pub2prv","privateblog_prv2pub","notepad_np2blog","recyclebin_recover_blog"];for(var n=0;n<i.length;++n){if(this._url.indexOf(i[n])!=-1){QZONE.FP._t.BLOG_DISPATCH_FLAG=1;QZONE.FP._t.setTimeout("QZONE.FP._t.BLOG_DISPATCH_FLAG = 0;",5*60*1e3);break}}if(this._succHandler){if(QZONE.userAgent.ie==8){this._tmpHandler=this._succHandler;setTimeout(QZONE.event.bind(window,function(e,t){e._tmpHandler.apply(null,t);e._tmpHandler=QZONE.emptyFn},this,arguments),0)}else{this._succHandler.apply(null,arguments)}}}this.sendStatCode(this._url,o,t)};this.create=function(e,t,o,i,n,r,a){if(this._bProcessing){if(!this._silentMode){
QZBlog.Util.showMsgbox("正在响应您的操作,请稍候...",6,QZBlog.Util.MSG_LIFTTIME.MIDDLE)}this._nProcessingTimer=setTimeout(QZONE.event.bind(this,function(){this._bProcessing=false}),5e3);return null}clearTimeout(this._nProcessingTimer);this._url=e;this._type=t=="post"?t:this._DEFAULT_TYPE;this._charset=!!n?n:this._DEFAULT_CHARSET;this._silentMode=!!r;this._callbackName=a?a:this._DEFAULT_CALLBACK_NAME;this._postType=this._DEFAULT_POSTTYPE;if(o){this._succHandler=o}if(i){this._errHandler=i}this._bProcessing=true;this.verifyHandler=null;this.loginHandler=null;this.pwdHandler=null;this.forbiddenHandler=null;this.rightHandler=null;this.alertHandler=null;this.confirmHandler=null;this.spaceCloseHandler=null;return this};this.setPostType=function(e){this._postType=e};this._preProcURL=function(e,t,o){if(e.indexOf(CGI_BLOG_R_DOMAIN)!=-1&&!!QZONE.FP._t.BLOG_DISPATCH_FLAG){e=e.replace(CGI_BLOG_R_DOMAIN,CGI_BLOG_DOMAIN)}if(t){e=QZBlog.Util.addDataToUri("g_tk",QZBlog.Util.getToken(),e)}if(o){
e=QZBlog.Util.addDataToUri("ref",QZBlog.Logic.isInPengyou?"qqcampus":"qzone",e)}if(/\/blog_add/i.test(e)||/\/blog_modify/i.test(e)||/\/ugcblog_add/i.test(e)||/\/add_comment/i.test(e)||/\/blog_quote/i.test(e)){var i="28Q1206"+QZBlog.Logic.SpaceHostInfo.getLoginUin()+"_"+QZBlog.Util.getSpaceUin();e=QZBlog.Util.addDataToUri("secverifykey",i,e)}return e};this.execute=function(){if(!this._silentMode){QZBlog.Util.showMsgbox("正在提交您的请求，请稍候...",6)}this._nStartTime=(new Date).getTime();if(this._type=="get"){var e=new QZONE.JSONGetter(this._preProcURL(this._url,true,true),void 0,null,this._charset);e.onSuccess=QZONE.lang.chain(QZONE.event.bind(this,this._callback),QZONE.event.bind(this,this.close));e.onError=QZONE.event.bind(this,this._defaultErrHandler);e.send(this._callbackName)}else if(this._type=="post"){this._url=this._preProcURL(this._url,true,true);var t=new QZFL.util.URI(this._url);var o=this._url.replace(t.search,"");var i=t.search.substring(1);if(this._postType==this._DEFAULT_POSTTYPE){
o=this._preProcURL(o,true,true);loadXMLAsync("tmpBlogXMLRequest",o,QZONE.event.bind(this,function(){try{this._callback(parent.g_XDoc["tmpBlogXMLRequest"]);delete parent.g_XDoc["tmpBlogXMLRequest"];parent.g_XDoc["tmpBlogXMLRequest"]=null}catch(e){}this.close()}),QZONE.event.bind(this,this._defaultErrHandler),true,i)}else{o=this._preProcURL(o,false,true);var n=new QZONE.FormSender(o,"post",i,this._charset);n.onSuccess=QZONE.event.bind(this,function(e){try{this._callback(e)}catch(e){}this.close()});n.onError=QZONE.event.bind(this,this._defaultErrHandler);n.send()}}else{return false}return true};this.excute=this.execute;this.close=function(){this._bProcessing=false;this._type=this._DEFAULT_TYPE;this._url="";this._charset=this._DEFAULT_CHARSET;this._silentMode=false;this._succHandler=QZONE.emptyFn;this._errHandler=QZONE.emptyFn;this._callbackName=this._DEFAULT_CALLBACK_NAME;this.verifyHandler=null;this.loginHandler=null;this.pwdHandler=null;this.forbiddenHandler=null;this.rightHandler=null
;this.alertHandler=null;this.confirmHandler=null};return this};QZBlog.Util.NetProcessor=new QZBlog.Util.BlogNetProcessor;(function(util){var FLASH_SENDER_ID="QZONE_BLOG_FLAHS_SENDER";var QZBLOG_FLASH_SENDER;var GUID=0;var REQ_INT_CTRL={};var LOGIN_SUCC_HANDLERS=[];var LOGIN_FAIL_HANDLERS=[];var RESPONSE_CODE_MAP={"-3000":"NO_LOGIN","-4001":"NO_LOGIN","-4002":"NO_LOGIN","-3001":"VERIFYCODE_REQUIRED","-4006":"VERIFYCODE_REQUIRED","-3002":"VERIFYCODE_ERROR","-4008":"VERIFYCODE_ERROR","-4007":"VERIFYCODE_IPC_CHECK","-4017":"TOBEAUDITED","-4015":"MSG_FORBIDDEN","-50000":"NEED_PWD2","-49999":"NEED_PWD2","-49998":"NEED_PWD2"};var RESPONSE_MSG_MAP={SUCCESS:"操作成功",TIMEOUT:"由于您的网络比较慢，请稍候再试",NO_LOGIN:"请先登录系统",ERROR:"您的操作暂时无法进行，请刷新页面后重新尝试",DATA_ERROR:"暂时无法获取服务器数据",VERIFYCODE_REQUIRED:"请输入验证码",VERIFYCODE_ERROR:"请输入正确的验证码",NEED_PWD2:"请输入空间二级密码"};var setCallback=function(e,t,o){top.window.MSG_Callback=function(i){console.log(i);if(i.ret===0){var n=new Date;var r=n.getTime();r+=2e3*3600;n.setTime(r)
;document.cookie="avg4_verify="+i.ticket+";expires="+n.toUTCString()+";domain=.qzone.qq.com;path=/;";document.cookie="avg4_randstr="+i.randstr+";expires="+n.toUTCString()+";domain=.qzone.qq.com;path=/;";e(i.ticket);setTimeout(function(){document.cookie="avg4_verify=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.qzone.qq.com;path=/;";document.cookie="avg4_randstr=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.qzone.qq.com;path=/;"},1e3)}else if(i.ret==2){if(o){o()}if(t){if(i.ticket!=""){e(i.ticket)}}else{e(i.ticket)}}}};function NetRequest(e){this.startTimeStamp=(new Date).getTime();this.config=QZFL.object.extend({url:null,data:{},method:"get",charset:"utf-8",callbackName:"_Callback",timeout:3e4,maxRequestInterval:500,useFlashMode:false,useTopQZFL:false,isSilenderMode:undefined,startMsgTimeout:1500},e);this.guid="NET_REQUEST_"+ ++GUID;this._startMsgTm=null;if(typeof this.config.data=="function"){this.config.datagetter=this.config.data;this.config.data=this.config["datagetter"]()}else{
var t=this;this.config.datagetter=function(){return t.config.data}}this.config.method=this.config.method.toLowerCase();if(!this.config.url||this.config.method!="get"&&this.config.method!="post"||this.config.method=="get"&&!this.config.callbackName){throw"NetRequest Parameters Error"}if(this.config.isSilenderMode==undefined){this.config.isSilenderMode=this.config.method!="post"}}NetRequest.prototype.onStart=function(){if(!this.config.isSilenderMode){this._startMsgTm=setTimeout(function(){QZBlog.Util.showMsgbox("正在响应您的操作,请稍候...",6)},this.config.startMsgTimeout)}};NetRequest.prototype.onSuccess=function(e){if(!this.config.isSilenderMode){var t;try{t=e.data.message}catch(e){}QZBlog.Util.showMsgbox(t||"操作成功",4)}};NetRequest.prototype.onError=function(e,t){if(!this.config.isSilenderMode){var o=t&&t.code?t.code:"";e=e+'<span style="color:#ddd; position:absolute">'+o+"</span>";QZBlog.Util.showMsgbox(e,1,QZBlog.Util.MSG_LIFTTIME.MIDDLE)}};NetRequest.prototype.onTimeout=function(){
this.onError(RESPONSE_MSG_MAP.TIMEOUT)};NetRequest.prototype.onResponse=function(e){if(!this.config.isSilenderMode){QZBlog.Util.hideMsgbox()}if(!e||typeof e.code=="undefined"){return this.onError(RESPONSE_MSG_MAP.DATA_ERROR,e)}var t=this;var o=e.message||RESPONSE_MSG_MAP.ERROR;if(e.code==0){this.onSuccess(e)}else if(RESPONSE_CODE_MAP[e.code]){switch(RESPONSE_CODE_MAP[e.code]){case"NO_LOGIN":this.loginHandler();break;case"NEED_PWD2":this.pwd2Handler();break;case"VERIFYCODE_REQUIRED":this.verifyHandler(QZBlog.Util.VerifycodeType.NORMALCODE);break;case"VERIFYCODE_IPC_CHECK":this.verifyHandler(QZBlog.Util.VerifycodeType.IPC_CHECK);break;case"VERIFYCODE_ERROR":this.verifyHandler(QZBlog.Util.VerifycodeType.ERRCODE);break;case"MSG_FORBIDDEN":this.msgForbiddenHandler(e);break;case"TOBEAUDITED":this.auditHandler(e);break;default:this.onError(o,e)}}else{this.onError(o,e)}};NetRequest.prototype.msgForbiddenHandler=function(e){if(QZONE.FP.showGagMsg){QZONE.FP.showGagMsg()}else{
this.onError(e.message,e)}};NetRequest.prototype.auditHandler=function(e){QZBlog.Util.showMsgbox(e.message||"提交成功",4);this.onSuccess(e)};NetRequest.prototype.loginHandler=function(){var e=this;QZONE.FP.showLoginBox(null,function(){var t=QZBlog.Logic.SpaceHostInfo.getLoginUin();QZFL.each(t?LOGIN_SUCC_HANDLERS:LOGIN_FAIL_HANDLERS,function(e){e(t)});if(t){e.config.data=e.config["datagetter"]();e.send()}})};NetRequest.prototype.verifyHandler=function(e){var t=this;var o=top.window.document;if(!o.getElementById("verify-script")){var i=o.createElement("script");i.id="verify-script";o.head.appendChild(i);i.onload=function(){top.document.getElementById("TencentCaptcha").click()};i.src="https://ssl.captcha.qq.com/TCaptcha.js";var n=o.createElement("button");n.id="TencentCaptcha";n.dataset.appid="9899145";n.dataset.cbfn="MSG_Callback";n.style.display="none";o.body.appendChild(n);setCallback(function(e){var o=QZBlog.Util.buildParam(t.config.data);t.send(null,o)},"",function(){})}else{
setCallback(function(e){var o=QZBlog.Util.buildParam(t.config.data);t.send(null,o)},"",function(){});o.getElementById("TencentCaptcha").click()}};NetRequest.prototype.pwd2Handler=function(){var e=this;QZBlog.Util.clearPwd2Sig();QZONE.FP.closePopup();QZBlog.Util.queryPwdState(function(){var t=QZBlog.Util.buildParam(e.config.data,{pwd2sig:QZBlog.Util.getPwd2Sig()});e.send(null,t)})};NetRequest.prototype.confirmHandler=function(e){if(confirm(e)){this.send()}};NetRequest.prototype._cgiStatic=function(e){var t=this.config.url;var o=(new Date).getTime()-this.startTimeStamp;var i=function(){try{stat_send_retcode2(t,e,o,true)}catch(e){}};if(typeof stat_send_retcode2!="function"){QZFL.imports("http://"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/script/retcode_stat.js",function(){i()},"utf-8")}else{i()}};NetRequest.prototype.requestFrequent=function(){return false};NetRequest.prototype.onFlashSenderCallback=function(params){var _this=this,_defErr="FLASH RESPONSE FORMAT ERROR";params=params||{}
;if(!params.id||params.error){this.onError(params.error||_defErr)}else if(params.id==this.guid){delete FlashSenderCallback.list[this.guid];var responseData;var getResponseData=function(str){str=str.replace(/[\s\S]*?frameElement\.callback\(/i,"").replace(/\)[\s\S]*?<\/script>[\s\S]+/g,"").replace(/\r|\n/g,"");eval("var data = "+str);if(data){return data}else{return null}};try{responseData=getResponseData(params.data);this.onResponse(responseData);_this._cgiStatic(responseData?responseData.code:"")}catch(e){this.onError(_defErr)}}};NetRequest.prototype.send=function(e,t){var o=this;var i=this.config.method=="post";this.startTimeStamp=(new Date).getTime();if(this.config.maxRequestInterval){var n=(new Date).getTime();var r=this.config.url;if(!REQ_INT_CTRL[r]){REQ_INT_CTRL[r]=n}else if(n-REQ_INT_CTRL[r]>this.config.maxRequestInterval){REQ_INT_CTRL[r]=n}else{var a=o.requestFrequent();if(a===false){return false}}}if(!e){
e=this.config.url.replace(/\&g_tk=(\d)*$/,"&g_tk="+QZBlog.Util.getToken())}e=e||this.config.url;t=QZBlog.Util.buildParam(t||this.config.data,{iNotice:this.config.isSilenderMode?"0":"1",inCharset:this.config.charset,outCharset:this.config.charset,format:i?"fs":"jsonp",ref:QZBlog.Logic.isInPengyou?"qqcampus":"qzone",json:i?1:null});if(i){t=QZBlog.Util.buildParam(t,{g_tk:QZBlog.Util.getToken()})}if(/\/blog_quote/i.test(this.config.url)||/\/add_comment/i.test(this.config.url)||/\/add_blog/i.test(this.config.url)||/\/quote_blog/i.test(this.config.url)||/\/mod_blog/i.test(this.config.url)||/\/blog_add/i.test(this.config.url)||/\/blog_modify/i.test(this.config.url)||/\/ugcblog_add/i.test(this.config.url)){var l="28Q1206"+QZBlog.Logic.SpaceHostInfo.getLoginUin()+"_"+QZBlog.Util.getSpaceUin();t=QZBlog.Util.buildParam(t,{secverifykey:l})}if(!i){var s=null;try{s=parent.$j.jsonGet}catch(e){}if(s){s(e,t,{cfn:this.config.callbackName,charset:this.config.charset,callback:function(e){o.onResponse(e)
;var t="data parser error";if(e&&typeof e.code!="undefined"){t=e.code}o._cgiStatic(t);o.reset()},onerror:function(e){var t=e&&e.message?e.message:"服务器繁忙，请稍候重试";o.onError(t,e);o._cgiStatic("json getter error");o.reset()},ontimeout:this.config.timeout||null})}else{var g=this.config.useTopQZFL?new top.QZFL.JSONGetter(e,void 0,t,this.config.charset):new QZFL.JSONGetter(e,void 0,t,this.config.charset);g.onSuccess=function(e){o.onResponse(e);var t="data parser error";if(e&&typeof e.code!="undefined"){t=e.code}o._cgiStatic(t);o.reset()};g.onError=function(e){var t=e&&e.message?e.message:"服务器繁忙，请稍候重试";o.onError(t,e);o._cgiStatic("json getter error");o.reset()};if(this.config.timeout){g.timeout=this.config.timeout}g.onTimeout=function(){o.onTimeout();o._cgiStatic("network error");o.reset()};g.send(this.config.callbackName)}}else{var c=0;var u=this.config.useTopQZFL?new top.QZFL.FormSender(e,this.config.method,t,this.config.charset):new QZFL.FormSender(e,this.config.method,t,this.config.charset)
;u.onSuccess=function(e){clearTimeout(c);o.onResponse(e);var t="data parser error";if(e&&typeof e.code!="undefined"){t=e.code}o._cgiStatic(t);o.reset()};u.onError=function(e){clearTimeout(c);var t=e&&e.message?e.message:"服务器繁忙，请稍候重试";o.onError(t,e);o._cgiStatic("formsender error");o.reset()};u.send();if(this.config.timeout){c=setTimeout(function(){o.onTimeout();u.onSuccess=u.onError=QZFL.emptyFn;o.reset()},this.config.timeout)}}this.onStart();return true};NetRequest.prototype.reset=function(){clearTimeout(this._startMsgTm);var e=this.config.url;if(REQ_INT_CTRL[e]){REQ_INT_CTRL[e]=(new Date).getTime()}};NetRequest.initFlashSender=function(){};NetRequest.addLoginFailHandler=function(e){LOGIN_FAIL_HANDLERS.push(e)};NetRequest.removeLoginFailHandler=function(e){var t=[];for(var o=0,i=LOGIN_FAIL_HANDLERS.length;o<i;o++){if(LOGIN_FAIL_HANDLERS[o]!=e){t.push(LOGIN_FAIL_HANDLERS[o])}}LOGIN_FAIL_HANDLERS=t};NetRequest.addLoginSuccHandler=function(e){LOGIN_SUCC_HANDLERS.push(e)}
;NetRequest.removeLoginSuccHanlder=function(e){var t=[];for(var o=0,i=LOGIN_SUCC_HANDLERS.length;o<i;o++){if(LOGIN_SUCC_HANDLERS[o]!=e){t.push(LOGIN_SUCC_HANDLERS[o])}}LOGIN_SUCC_HANDLERS=t};util.NetRequest=NetRequest})(QZBlog.Util);QZBlog.Util.PaperLetterManager={cleanAllPaperStyle:function(){$("paperPicArea").style.cssText="display:none;";$("paperPicArea0").style.cssText="display:none;";$("paperPicArea1").style.cssText="position:relative;display:none;top:auto;";$("paperPicArea0").src=$("paperPicArea1").src=$("paperPicArea").src="/ac/b.gif";$("veryContent").style.cssText="padding-bottom:20px;height:auto;";$("paperTitleArea").style.cssText="";try{var e=document.styleSheets[0];e.removeRule(e.length-1);e.removeRule(e.length-1)}catch(e){}},doPaint:function(e,t){if(!e){return false}if(QZBlog.Util.getSpaceMode()>=5){return false}if(QZBlog.Util.getSpaceMode()==4||QZBlog.Util.isOldXWMode()){e.setModeType(0)}var o=e.getID();var i=e.getStyle();var n=e.getType();var r=e.getFlag()
;var a=e.getTitleColor();var l=e.getBGColor();var s=e.getParams();if(!!$("veryTitle"))$("veryTitle").style.display="none";$("paperTitle").innerHTML=e.getPaperTitleHTML(t);var g=$("paperTitleArea");var c=$("blogContentTable");var u=n==1||n==3?$("paperPicArea0"):$("paperPicArea");if(!g||!c||!u)return;u.style.display="block";$("paperTitle").style.color=$("blogDetailDiv").style.color=a;try{var d=document.styleSheets[0];d.addRule("#blogContainer a:link","{color:"+a+";}",d.length);d.addRule("#blogContainer a:visited","{color:"+a+";}",d.length)}catch(e){}g.style.height=s[n][4]+"px";g.style.width=e.MINWIDTH-s[n][1]-s[n][3]+"px";$("paperTitle").style.paddingTop=s[n][4]/2-10+"px";$("blogContainer").style.paddingRight=e.HORI_PADDING+"px";$("blogContainer").style.paddingLeft=e.HORI_PADDING+"px";u.style.width=s[n][5]+"px";$("paperBottom").style.paddingTop=s[n][2]+"px";$("veryContent").style.cssText="height:auto!important; min-height:"+e.MINHEIGHT+"px;";$("veryContent").style.overflowY="visible"
;$("veryContent").style.backgroundColor=l;if(n==2){$("veryContent").style.backgroundPositionX="right"}else if(n==4){$("veryContent").style.backgroundPositionY="bottom"}var f=e.getBackgroundImgUrl();QZBlog.Util.ImageManager.loadImage(f,true,function(){setTimeout(function(){$("veryContent").style.backgroundImage="url("+f+")"},1)});switch(n){case 1:g.style.paddingTop=s[n][0]+"px";g.style.paddingBottom=s[n][4]/2+"px";g.style.marginLeft=s[n][5]-e.HORI_PADDING+"px";u.style[QZFL.userAgent.ie?"styleFloat":"cssFloat"]="left";u.style.marginLeft=e.HORI_PADDING*-1+"px";break;case 2:g.style.marginTop=s[n][0]+"px";g.style.marginBottom=s[n][4]/2+"px";u.style[QZFL.userAgent.ie?"styleFloat":"cssFloat"]="right";u.style.marginTop=(s[n][0]+s[n][4]*1.5)*-1+"px";u.style.marginRight=e.HORI_PADDING*-1+"px";break;case 3:g.style.marginLeft=(s[n][1]+s[n][3]-e.HORI_PADDING)/2+"px";g.style.marginBottom=s[n][4]/2+"px";if(QZONE.userAgent.Safari){u.style.marginLeft=e.HORI_PADDING*-2+6+"px"
;u.style.width=s[n][5]+e.HORI_PADDING+"px"}else{u.style.marginLeft=e.HORI_PADDING*-1+"px"}if(r!=1){u.style.display="block";u.style.width="auto"}else{u.style.height=s[n][6]+"px"}break;case 4:g.style.marginLeft=(s[n][1]+s[n][3]-e.HORI_PADDING)/2+"px";g.style.marginBottom=s[n][4]/2+"px";g.style.marginTop=s[n][4]/2+"px";u.style.display="none";u=$("paperPicArea1");u.style.display="";u.style.width=s[n][5]+"px";if(r!=1){u.style.display="block";u.style.width="auto"}else{u.style.height=s[n][6]+"px"}u.style.left="0px";$("paperBottom").style.paddingTop="0px";break;case 5:u.style.display="none";g.style.marginLeft=(s[n][1]+s[n][3])/2-18+"px";g.style.marginTop="60px";g.style.marginBottom=s[n][4]/2+"px";$("blogContainer").style.overflowY="visible";var p=parseInt($("blogContainer").offsetHeight,10);$("blogContainer").style.height=s[n][6]?(p>s[n][6]?p:s[n][6])+"px":"auto";$("blogContainer").style.paddingTop=s[n][4]/2+"px";$("blogContainer").style.backgroundRepeat="no-repeat"
;$("blogContainer").style.backgroundPosition="top";break;default:throw"错误的信纸类型";break}g.style.backgroundPosition="center";g.style.backgroundRepeat="no-repeat";var _=e.getTitleImgUrl();QZBlog.Util.ImageManager.loadImage(_,true,function(){g.style.backgroundImage="url("+_+")"});if(n==4){u.style.bottom=c.offsetHeight-$("veryContent").offsetHeight+"px"}var h=e.getDescImgUrl();QZBlog.Util.ImageManager.loadImage(h,true,function(){if(n!=5){u.src=h;if(o==81177||o==93007){if(!QZBlog.Logic.SpaceHostInfo.getLoginUin()||!QZBlog.Util.getLoginIsVIP()){var e=$("blogContainer");if(e.childNodes[0].id!="vipLinkButton"){var t=document.createElement("div");t.className="default_free_letter default_free_letter_"+o;t.id="vipLinkButton";e.insertBefore(t,e.firstChild);t.innerHTML='<p style="top:13px;"><span class="none">尊享无限量精美信纸！立即</span><a href="http://pay.qq.com/qzone/index.shtml?aid=freepaper.anniu" target="_blank">开通黄钻</a></p>'}else{$("vipLinkButton").style.display="block"}}}}else{
$("blogContainer").style.backgroundImage="url("+h+")"}});if(r==1){var m=e.getFlashUrl();var v=document.createElement("span");document.body.appendChild(v);v.innerHTML='<object type="application/x-shockwave-flash" data="'+m+'" width="'+u.style.width+'" height="'+s[n][6]+'" style="'+u.style.cssText+'" align="middle">'+'<param name="movie" value="'+m+'" />'+'<param name="quality" value="high" />'+'<param name="bgcolor" value="#ffffff" />'+'<param name="play" value="true" />'+'<param name="loop" value="true" />'+'<param name="wmode" value="transparent" />'+"</object></span>";QZFL.dom.swapNode(u,v.getElementsByTagName("object")[0]);u.style.display="none"}return true}};QZBlog.Util.formatMsg=function(e,t,o){var i=/\{([\w-]+)?\}/g;return function(e,t,o){return e.replace(i,function(e,i){return o?o(t[i],i):t[i]})}}();QZBlog.Util.isEM=function(e){return/em\/e(\d{1,3}).gif/i.test(e)};QZBlog.Util.isBlankImg=function(e){return/\/ac\/b.gif/i.test(e)};QZBlog.Util.isLoadingImg=function(e){
return/qzone\/newblog\/v5\/editor\/css\/loading.gif$/i.test(e)||/aoi\/img\/icenter\/loading.gif$/i.test(e)};QZBlog.Util.isNonsenseImg=function(e){return QZBlog.Util.isEM(e)||QZBlog.Util.isBlankImg(e)||QZBlog.Util.isLoadingImg(e)};QZBlog.Util.isQqUin=function(e){return/^\d{5,20}$/g.test(e)};QZBlog.Util.getSpaceUrl=function(e){return this.isQqUin(e)?"//user.qzone.qq.com/"+e:"http://profile.pengyou.com/index.php?mod=profile&u="+e};QZBlog.Util.isMultipleByte=function(e){var t=parseInt(e.toString(16),16);if(t<0||t>255)return true;return false};QZBlog.Util.long2time=function(e){var t=new Date(e*1e3);return[t.getFullYear(),"年",t.getMonth()+1,"月",t.getDate(),"日 ",t.getHours(),"时",t.getMinutes(),"分",t.getSeconds(),"秒"].join("")};QZBlog.Util.long2ShortTime=function(e){var t=new Date(e*1e3);var o=t.getMinutes().toString();var i=t.getSeconds().toString();o=o.length<2?"0"+o:o;i=i.length<2?"0"+i:i;return[t.getHours(),":",o,":",i].join("")};QZBlog.Util.long2LongTime=function(e){var t=new Date(e*1e3)
;var o=t.getMinutes().toString();var i=t.getSeconds().toString();var n=t.getHours().toString();o=o.length<2?"0"+o:o;i=i.length<2?"0"+i:i;n=n.length<2?"0"+n:n;var r=(t.getMonth()+1).toString();var a=t.getDate().toString();r=r.length<2?"0"+r:r;a=a.length<2?"0"+a:a;return[t.getFullYear(),"-",r,"-",a," "].join("")+[n,":",o,":",i].join("")};QZBlog.Util.long2DateTime=function(e){if(!e){return""}var t=new Date(e*1e3);return t.getMonth()+1+"月"+t.getDate()+"日 "+(t.getHours()<10?" 0":" ")+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()};QZBlog.Util.getMonthSpanTime=function(e,t){var o=new Date(e,t-1,1);var i=new Date(e+(t==12?1:0),t==12?0:t,1);return{start:o.getTime()/1e3,end:i.getTime()/1e3}};QZBlog.Util.jumpTop=function(e){var t=QZONE.FP.getQzoneConfig().full?parent.document:document;var o=t[t.compatMode=="CSS1Compat"&&!QZFL.userAgent.webkit?"documentElement":"body"];if(e&&window.frameElement){var i=QZFL.dom.getXY(window.frameElement)
;var n=QZFL.userAgent.ie==6&&!(this.getSpaceMode()==1||QZBlog.Util.isOldXWMode());o.scrollTop=i[1]-41}else{o.scrollTop=0}};QZBlog.Util.setPageAutoResize=function(e){if(!frameElement){return}e=parseInt(e,10)||3e3;var t=false;var o=function(){if(t||frameElement.height==document.body.offsetHeight){return}t=true;setTimeout(function(){window.frameElement.height=document.body.offsetHeight;t=false},e)};if(QZFL.userAgent.ie&&QZFL.userAgent.ie<9){QZFL.event.addEvent(window,"resize",o)}else{QZFL.event.addEvent(document.body,"DOMSubtreeModified",o)}};QZBlog.Util.getBlogRDomain=function(){if(!!QZONE.FP._t.BLOG_DISPATCH_FLAG){return CGI_BLOG_DOMAIN}return CGI_BLOG_R_DOMAIN};QZBlog.Util.getRecycleUrl=function(){return"//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/recycle.html"};QZBlog.Util.getEditBlogUrl=function(e,t){var o=QZBlog.Logic.isInPengyou?"editor.pengyou.html":"editor.html";return QZBlog.Util.mergeStaticUri("//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/"+o,e,t?"source="+t:"")}
;QZBlog.Util.getEditPhotoBlogUrl=function(e,t){return QZBlog.Util.mergeStaticUri("//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V6_PATH+"/photoBlogEdit.html",e,t?"source="+t:"")};QZBlog.Util.getEditTemplateBlogUrl=function(e,t){var o=QZBlog.Logic.isInPengyou?"editor.pengyou.html":"editor.html";return QZBlog.Util.mergeStaticUri("//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/"+o,e,t?"source="+t:"","exblogtype=2")};QZBlog.Util.getNewBlogListUrl=function(e,t){var o=QZBlog.Util.buildParam(e,t?"source="+t:"");if(!frameElement){var i=window.location.protocol+"//"+(QZBlog.Logic.isInPengyou?"baseapp.pengyou.com":"user.qzone.qq.com")+"/"+QZBlog.Logic.SpaceHostInfo.getUin()+"/blog/";return QZBlog.Util.mergeCgiUri(i,o)}return QZBlog.Util.mergeStaticUri("//"+IMGCACHE_DOMAIN+(QZBlog.Logic.isInPengyou?IMGCACHE_BLOG_PENGYOU_PATH:IMGCACHE_BLOG_V6_PATH)+"/bloglist.html",o)};QZBlog.Util.buildParam=function(){var e=function(e){return typeof e=="string"||typeof e=="number"};var t=function(e,t,o){e=e||""
;var i=QZFL.lang.arg2arr(arguments);var n=e.split("&");var r=[];i=i.slice(1);for(var a=0;a<i.length;a++){for(var l=0;l<n.length;l++){if(n[l].indexOf(i[a]+"=")==0){r.push(n[l])}}}return r.join("&")};var o=function(e){var o=[];var i=QZBlog.Util.parseStringToObjParam(e,false);for(var n in i){if(n!="rc"&&n!="rg"){o.push(n+"="+i[n])}}var r=t(e,"rc","rg");if(r){o.push(r)}return o.join("&")};return function(){var t=QZFL.lang.arg2arr(arguments),i=[];QZFL.each(t,function(t){if(QZFL.lang.isArray(t)){i.push(t.join("&"))}else if(typeof t=="object"){for(var o in t){if(e(t[o])){i.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]))}}}else if(typeof t=="string"){i.push(t)}});var n=i.join("&").replace(/^[?|#|&]{0,1}(.*?)[?|#|&]{0,1}$/g,"$1");return o(n)}}();QZBlog.Util.mergeCgiUri=function(){var e=QZFL.lang.arg2arr(arguments);var t=e[0];t=t.replace(/(.*?)[?|#|&]{0,1}$/g,"$1");e=e.slice(1);QZFL.each(e,function(e){var o=QZBlog.Util.buildParam(e);if(o){t+=(t.indexOf("?")>=0?"&":"?")+o}});return t}
;QZBlog.Util.mergeStaticUri=function(){var e=QZFL.lang.arg2arr(arguments);var t=e[0];e=e.slice(1);QZFL.each(e,function(e){var o=QZBlog.Util.buildParam(e);if(o){t+=/(\?|#|&)$/.test(t)?"":/\?|#|&/.test(t)?"&":"#";t+=o}});return t};QZBlog.Util.parseStringToObjParam=function(e,t){if(typeof e!="string"||!e){return{}}var o={},i,n=e.split("&");for(var r=0,a=n.length;r<a;++r){i=n[r].split("=");o[i[0]]=t?decodeURIComponent(i[1]):i[1]}return o};QZBlog.Router=function(){var e=parent.imgcacheDomain;var t={addblog:1,addprivateblog:1,addtemplateblog:1,addblogv5:1,addphotoblog:1,draftcontent:1,privatecontent:1,recycle:1};return{redirectTo:function(e,t,o){var i=QZFL.lang.arg2arr(arguments);var n=this.getSubPageUrl.apply(this,i);if(o){window.open(n)}else{setTimeout(function(){console.log("[BLOG] redirectTo",n);if(n.indexOf("?")>-1||n.indexOf("#")>-1){n+="&g_iframeUser=1"}else{n+="?g_iframeUser=1"}window.location.href=n},0)}},getSubPageUrl:function(e,o,i){i=i||QZBlog.Logic.isSeoPage;e=e.toLowerCase()
;var n=QZBlog.Util.buildParam(o);o=QZBlog.Util.parseStringToObjParam(n,true);var r;var a=o.uin||t[e]?QZBlog.Logic.SpaceHostInfo.getLoginUin():QZBlog.Logic.SpaceHostInfo.getUin();var l=QZBlog.Logic.isInPengyou?location.protocol+"//baseapp.pengyou.com/":location.protocol+"//user.qzone.qq.com/"+a;switch(e){case"photobloglist":case"bloglist":r=i?QZBlog.Util.mergeCgiUri(l+"/blog",o):this.patchFilePath(QZBlog.Logic.isInPengyou?"app/blog/pengyou/bloglist.html":"app/blog/v6/bloglist.html",o);break;case"blogcontent":var s=o.blogId;o.blogId=null;if(i){r=QZBlog.Util.mergeCgiUri(l+"/blog/"+s,o)}else{r=QZBlog.Util.mergeCgiUri(QZBlog.Util.getContentCGIUrl(a,s),o)}break;case"draftcontent":var g=o.draftId;o.draftId=null;if(i){throw"草稿暂不支持新窗口打开"}r=QZBlog.Util.mergeCgiUri(QZBlog.Util.getDraftContentCGIUrl(a,g),o);break;case"privatecontent":var s=o.blogId;o.blogId=null,r=i?QZBlog.Util.mergeCgiUri(l+"/blog/"+s,o):QZBlog.Util.mergeCgiUri(QZBlog.Util.getPrivateContentCGIUrl(s),o);break;case"recycle":
r=i?QZBlog.Util.mergeCgiUri(l+"/blog/?catalog=recycle",o):this.patchFilePath("app/blog/bloglist.html#catalog=recycle",o);break;case"msgboard":r=i?QZBlog.Util.mergeCgiUri(l+"/msgboard",o):this.patchFilePath("msgboard/msgbcanvas.html",o);break;case"addblog":case"addprivateblog":case"addtemplateblog":if(e=="addtemplateblog"){o=QZBlog.Util.buildParam(o,"exblogtype=2")}if(e=="addprivateblog"){o=QZBlog.Util.buildParam(o,"isPrivate=1")}r=i?QZBlog.Util.mergeCgiUri(l+"/blog/add",o):this.patchFilePath("newblog/v5/"+(QZBlog.Logic.isInPengyou?"editor.pengyou.html":"editor.html"),o);break;case"addphotoblog":r=i?QZBlog.Util.mergeCgiUri(l+"/blog/addPhoto",o):this.patchFilePath("app/blog/v6/photoBlogEdit.html",o);break;case"addgridblog":r=i?QZBlog.Util.mergeCgiUri(l+"/blog/addgrid",o):this.patchFilePath("newblog/v5/grid_editor.html",o);break;default:throw"NO ROUTER FOUND"}return r},patchFilePath:function(t,o){var i=location.protocol+"//"+e+"/qzone/"+t;try{if(top.g_iframeUser){
var n=top.g_cgidomain+".qzone.qq.com/proxy/domain/"+e;i=location.protocol+"//"+n+"/qzone/"+t}}catch(e){}return QZBlog.Util.mergeStaticUri(i,o)}}}();QZBlog.Util.getNewBlogListUrlData=function(e){return QZFL.object.extend({hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),uin:QZBlog.Logic.SpaceHostInfo.getLoginUin()||null,blogType:0,cateName:"",cateHex:"",statYear:"",reqInfo:1,pos:0,num:15,sortType:0,absType:0,startTime:"",endTime:"",source:0,rand:Math.random(),ref:QZBlog.Logic.isInPengyou?"qqcampus":"qzone",g_tk:QZBlog.Util.getToken()},e)};QZBlog.Util._realURL2ProxyURL=function(e){try{return window.location.protocol+"//"+(QZONE.FP._t.g_cgidomain||"h5")+".qzone.qq.com/proxy/domain/"+e.replace(/^http:\/\//,"")}catch(t){return e}};QZBlog.Util._isBetaUser=function(){var e=QZONE.FP.getQzoneConfig("ownerUin"),t=QZONE.FP.getQzoneConfig("isOwner");return t};QZBlog.Util._isspeedup=function(){
var e=parent.location.host,t=parent.document.cookie.indexOf("blabla=dynamic")>-1,o=t&&/(?:^user\.(s\d\.)?|\d{5,}\.|rc\.)qzone\.qq\.com/.test(e);return o};QZBlog.Util.canUseDomainRevert=function(e){return QZBlog.Util._isspeedup()&&QZBlog.Util._isBetaUser()};QZBlog.Util.getContentCGIUrl=function(e,t,o,i){if(!frameElement){return"http://"+(QZBlog.Logic.isInPengyou?"baseapp.pengyou.com":"user.qzone.qq.com")+"/"+e+"/blog/"+t+"?1=1"}var n={uin:e,blogid:t,styledm:STYLE_DOMAIN,imgdm:IMGCACHE_DOMAIN,bdm:CGI_BLOG_DOMAIN,mode:QZBlog.Util.isSmallMode()?0:QZBlog.Util.isWideMode()?2:1,numperpage:CONTENT_COMMENT_NUM,property:parent.g_Property,timestamp:parent.g_NowTime,dprefix:QZONE.FP._t.g_DPrefix,numperpage:CONTENT_COMMENT_NUM,blogseed:o>0?o:undefined,inCharset:"gb2312",outCharset:"gb2312",ref:QZBlog.Logic.isInPengyou?"qqcampus":"qzone"};var r=QZBlog.CGI_URL.get("blog_output_data");try{QZBlog.Util.Statistic.sendPV("userhost."+(r.match(/\/\/(.*).qzone.qq\.com/)[1]||""))}catch(e){
r=QZBlog.CGI_URL.get("blog_output_data")}var a=QZBlog.Util.mergeCgiUri(r,n,i);return a};QZBlog.Util.getDraftContentCGIUrl=function(e,t,o,i){var n={uin:e,draftid:t,styledm:STYLE_DOMAIN,imgdm:IMGCACHE_DOMAIN,bdm:CGI_BLOG_DOMAIN,timestamp:parent.g_NowTime,g_tk:QZBlog.Util.getToken(),draftseed:o>0?o:undefined,ref:QZBlog.Logic.isInPengyou?"qqcampus":"qzone",pwd2sig:i?QZBlog.Util.getPwd2Sig():undefined};return QZBlog.Util.mergeCgiUri(QZBlog.CGI_URL.get("draft_output_data","draft"),n)};QZBlog.Util.getEditGridBlogUrl=function(e,t){return QZBlog.Util.mergeStaticUri("//"+IMGCACHE_DOMAIN+IMGCACHE_BLOG_V5_PATH+"/grid_editor.html",e,t?"source="+t:"")};QZBlog.Util.getPrivateContentCGIUrl=function(e,t){t=t||(QZONE.FP._t.BlogNavigator?QZONE.FP._t.BlogNavigator[e]:Math.random());if(!t){t=QZONE.FP._t.BlogNavigator[e]=Math.random()}var o={uin:QZBlog.Logic.SpaceHostInfo.getUin(),blogid:e,pwd2sig:QZBlog.Util.getPwd2Sig(),styledm:STYLE_DOMAIN,imgdm:IMGCACHE_DOMAIN,bdm:CGI_BLOG_DOMAIN,rs:t,private:1,
ref:QZBlog.Logic.isInPengyou?"qqcampus":"qzone"};return QZBlog.Util.mergeCgiUri(QZBlog.CGI_URL.get("privateblog_output_data","private"),o)};QZBlog.Util.getCommentCGIUrl=function(e,t,o,i,n){var r={uin:e,num:o,topicId:QZBlog.Logic.SpaceHostInfo.getUin()+"_"+t,start:i,r:n>0?n:undefined};return QZBlog.Util.mergeCgiUri(QZBlog.CGI_URL.get("get_comment_list"),r)};QZBlog.Util.effectSplit=function(e){if(e<=0||isNaN(e)){return[]}var t=[];var o=e.toString(2);var i=o.length;var n=/^1[0]*/;while(i>0){t.push((1<<i-1)+"");o=o.replace(n,"");i=o.length}return t};QZBlog.Util.scrollToElement=function(e,t,o){var i;var n=QZBlog.Util.getCurrentAppWindow().frameElement?QZFL.dom.getPosition(QZBlog.Util.getCurrentAppWindow().frameElement).top:0;if(QZBlog.Util.isSmallMode()){i=QZFL.dom.getPosition(e).top}else{i=QZFL.dom.getPosition(e).top+n-30}t=!!t?t:1;var r=QZBlog.Util.isSmallMode()?document:parent.document;var a=r[r.compatMode=="CSS1Compat"&&!QZFL.userAgent.webkit?"documentElement":"body"];a.scrollTop=i}
;QZBlog.Util.TimerManager={_timerList:[],setTimeout:function(e,t){var o=Array.prototype.slice.call(arguments,2);var i=window.setTimeout(function(){e.apply(null,o)},t);this._timerList.push(i);return i},clear:function(){for(var e=0;e<this._timerList.length;++e){clearTimeout(this._timerList[e])}}};QZBlog.Util.clearAllCacheData=function(){parent.BlogListNavigator.clear();parent.BlogListNavigator.removePageData();parent.g_oCateInfoMgr.clear();parent.g_oBlogInfoMgr.clearAllBlogInfo();PAGE_CACHE.clean("HostRecentBlogList")};QZBlog.Util.PageIndexManager={init:function(e,t,o,i,n){if(!e||e.length==0||t<1||o<1||t<o){return false}this._currentIndex=o;this._totalIndex=t;this._containerArr=e;this._callback=typeof i=="function"?i:QZONE.emptyFn;this._templateHTML=typeof n!="undefined"?n:this._templateHTML;this._updatePage();this._bInitialized=true},getCurrentIndex:function(){if(!this._bInitialized){return-1}return this._currentIndex},goPage:function(e){if(!this._bInitialized){return false}
if(e!=1&&e!=-1){return false}if(e==-1&&this._currentIndex==1){QZBlog.Util.showMsgbox("当前页已经是第一页!",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);return false}if(e==1&&this._currentIndex==this._totalIndex){QZBlog.Util.showMsgbox("当前页已经是最后一页!",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);return false}this._showPage(this._currentIndex+e);return true},goDirectPage:function(e){if(!this._bInitialized){return false}e=parseInt(e,10);if(isNaN(e)){QZBlog.Util.showMsgbox("请填入正确的页码!",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);return false}if(e<1||e>this._totalIndex){QZBlog.Util.showMsgbox("此页码不存在!",1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);return false}if(e!=this._currentIndex){this._showPage(e)}try{if(/blog_output_data/.test(location.href)){QZBlog.Util.Statistic.sendPV("comment_btn_comfirm","blogtest.qzone.qq.com")}else if(/blog/.test(location.href)){QZBlog.Util.Statistic.sendPV("list_btn_confirm","blogtest.qzone.qq.com")}}catch(e){}return true},_showPage:function(e){this._currentIndex=e;this._updatePage()
;this._callback(this._currentIndex)},_updatePage:function(){var e=[];var t=Math.max(this._currentIndex-3,1);var o=Math.min(t+6,this._totalIndex);t=Math.max(o-6,1);for(var i=t;i<=o;++i){if(t>=2&&i==t){e.push('<a href="javascript:;" class="c_tx" onclick="QZBlog.Util.PageIndexManager.goDirectPage(1);return false;">1<a> <span class="mod_pagenav_more"><span>…</span></span> ');continue}if(o<=this._totalIndex-1&&i==o){e.push('<span class="mod_pagenav_more"><span>…</span></span> <a href="javascript:;" class="c_tx" onclick="QZBlog.Util.PageIndexManager.goDirectPage('+this._totalIndex+');return false;">'+this._totalIndex+"</a> ");continue}e.push(i!=this._currentIndex?'<a href="javascript:;" class="c_tx" onclick="QZBlog.Util.PageIndexManager.goDirectPage('+i+');return false;">'+i+"</a> ":' <span class="current"><span>'+i+"</span></span> ")}this._pageData.firstDisabled=this._currentIndex==1?true:false;this._pageData.nextDisabled=this._currentIndex==this._totalIndex?true:false
;this._pageData.firstDisableClass=this._pageData.firstDisabled?"":"none";this._pageData.firstAvailClass=this._pageData.firstDisabled?"none":"";this._pageData.nextDisableClass=this._pageData.nextDisabled?"":"none";this._pageData.nextAvailClass=this._pageData.nextDisabled?"none":"";this._pageData.centerPageHTML=e.join("");this._pageData.currentPage=this._currentIndex;for(var i=0;i<this._containerArr.length;++i){if(this._containerArr[i].id){this._containerArr[i]=$(this._containerArr[i].id)}this._containerArr[i].innerHTML=doFill(this._templateHTML,{data:this._pageData});QZONE.event.addEvent($("pageIndex_input"+this._pageData.index),"keypress",function(e){e=QZONE.event.getEvent(e);if(e.keyCode==13){QZBlog.Util.PageIndexManager.goDirectPage(QZONE.event.getTarget().value.trim())}});++this._pageData.index}},_bInitialized:false,_currentIndex:-1,_totalIndex:-1,_callback:null,_containerArr:null,_pageData:{firstDisabled:false,centerPageHTML:false,nextDisabled:"",currentPage:1,index:1},
_templateHTML:'<%repeat_0 match="/data"%><div class="mod_pagenav"><p class="mod_pagenav_main">'+'<span class="mod_pagenav_disable <%=@firstDisableClass%>"><span>上一页</span></span><a onclick="QZBlog.Util.PageIndexManager.goPage(-1);return false;" class="c_tx <%=@firstAvailClass%>" href="javascript:;">上一页</a>'+' <span class="mod_pagenav_count"><%=@centerPageHTML%></span> '+'<span class="mod_pagenav_disable <%=@nextDisableClass%>"><span>下一页</span></span><a class="c_tx <%=@nextAvailClass%>" onclick="QZBlog.Util.PageIndexManager.goPage(1);return false;" href="javascript:;">下一页</a> '+'</p><p class="mod_pagenav_option"><span class="mod_pagenav_turn">转到<input class="textinput" type="text" id="pageIndex_input<%=@index%>" value="<%=@currentPage%>" /> 页 '+'<button onclick="QZBlog.Util.PageIndexManager.goDirectPage($(\'pageIndex_input<%=@index%>\').value.trim());" type="button" class="bt_tx2">确 定</button></p></div><%_repeat_0%>'};QZBlog.Util.pwd2Verified=function(){
return!(QZONE.FP._t.QZFL.dataCenter.get("pwd2sig")==""||typeof QZONE.FP._t.QZFL.dataCenter.get("pwd2sig")=="undefined")};QZBlog.Util.clearPwd2Sig=function(){QZONE.FP._t.QZFL.dataCenter.del("pwd2sig")};QZBlog.Util.savePwd2Sig=function(e){QZONE.FP._t.QZFL.dataCenter.save("pwd2sig",e,"memory")};QZBlog.Util.getPwd2Sig=function(){return typeof QZONE.FP._t.QZFL.dataCenter.get("pwd2sig")=="undefined"?"":QZONE.FP._t.QZFL.dataCenter.get("pwd2sig")};QZBlog.Util.queryPwdState=function(e,t){if(QZBlog.Util.pwd2Verified()){e();return}QZBlog.Util._doQueryPwdFrame("verify",e,t)};QZBlog.Util._doQueryPwdFrame=function(e,t,o){QZBlog.Util.showMsgbox("正在查询独立密码，请稍候……",6,QZBlog.Util.MSG_LIFTTIME.MIDDLE);var i=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("pwd2c_query_iframe"),data:{uin:QZBlog.Logic.SpaceHostInfo.getUin(),action:e,redirecturl:window.location.protocol+"//qzs.qq.com"+IMGCACHE_BLOG_V5_PATH+"/pwd/callback.html",r:Math.random(),fupdate:1},method:"get",uniqueCGI:true});i.onSuccess=function(e){
e=e.data;window.nMaskID=QZFL.maskLayout.create(5e3,document);window.pwdDialog=QZFL.dialog.create("",{src:(e.iframeurl||"").replace("http://","//")+"&ipwd_tg=window"},{width:403,height:312,useTween:false,noBorder:true,top:150});window.pwdDialog.onUnload=function(){t();QZFL.maskLayout.remove(window.nMaskID)}};i.onError=function(e){QZBlog.Util.showMsgbox(e||"服务器繁忙，请稍后重试",5,QZBlog.Util.MSG_LIFTTIME.MIDDLE);if(typeof o=="function"){o()}};i.send()};QZBlog.Util.changePwd=function(){QZBlog.Util._doQueryPwdFrame("modify",QZONE.emptyFn)};function CloseAlert(){window.pwdDialog.onUnload=QZONE.emptyFn;window.pwdDialog.unload();QZFL.maskLayout.remove(window.nMaskID)}QZBlog.Util.NamecardInitiator={loaded:false,loadScript:function(){var e=new QZONE.jsLoader;e.onload=QZONE.event.bind(this,function(){this.loaded=true});e.load("http://"+IMGCACHE_DOMAIN+"/qzone/v5/namecardv2.js",document,"utf-8")},initArea:function(e){if(!this._checkReady(QZONE.event.bind(this,this.initArea,e))){return}
QZBlog.Util.TimerManager.setTimeout(function(){try{QZONE.namecard.init(e)}catch(e){}},2e3)},_checkReady:function(e){if(!this.loaded){QZBlog.Util.TimerManager.setTimeout(QZONE.event.bind(this,e),100);return false}return true}};QZBlog.Util.parseTimeString=function(e){var t=e.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/);if(t&&t.length>3){return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]))}t=e.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/);if(t&&t.length>6){return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6]))}t=e.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,9}) *$/);if(t&&t.length>7){return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6]),parseInt(t[7]))}return null};QZBlog.Util.createAd=function(e,t,o,i,n,r){o=o===undefined?1:o;if(!e||!t||!t.nodeType){return}if(typeof QBS=="undefined"&&!r){
QZFL.imports("http://"+IMGCACHE_DOMAIN+"/qzone/biz/comm/js/qbs.js",function(){QZBlog.Util.createAd(e,t,o,i,n,true)});return}var n=n||function(e){var o=QZBlog.Util.renderAd(e,i);if(o){t.innerHTML=o;t.style.display=""}};QBS&&QBS.get(e,t,o,false,n)};QZBlog.Util.loadQBossAd=function(){var e=function(){var t=QZBlog.Util.getLoginIsVIP();var o="user-state-"+(t?"vip":"normal");QZFL.css.addClassName(document.body,o);QZFL.css.insertStyleSheet(null,"."+o+(t?" .showInVip":" .showInNoVip")+"{display:block !important;}");e=QZFL.emptyFn};return function(t,o){e();var i="http://boss.qzone.qq.com/fcg-bin/fcg_get_strategy";var n=QZBlog.Logic.isInPengyou?QZBlog.Util.getPengyouDecodeUin():QZBlog.Logic.SpaceHostInfo.getLoginUin();n=n||0;var r={uin:n,board_id:t};var a="qzone_blog_qboss_ad"+t;var l=PAGE_CACHE.get(a);if(l){o(l.extdata,l.adData,l.response);return}var s=new QZBlog.Util.NetRequest({url:i,data:r,charset:"utf-8",isSilenderMode:true});s.onSuccess=function(e){
var i=QZFL.object.route(e,"data."+t+".items.0")||{};var n=i.extdata;if(n){o(n,i,e);PAGE_CACHE.add(a,{extdata:n,adData:i,response:e},3600)}};s.send()}}();QZBlog.Util.reportQBossState=function(e,t){var o="http://boss.qzone.qq.com/fcg-bin/fcg_rep_strategy";var i={from:0,uin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),qboper:t||2,bosstrace:e};var n=new parent.Image;n.src=QZBlog.Util.mergeCgiUri(o,i);console.log("AD CLICK",n.src)};QZBlog.Util.renderAd=function(e,t){if(!e||!e.data||!e.data.length){return""}var o=[],t=t||{};if(t.type=="img"){for(var i=0;i<e.data.length;i++){var n=e.data[i];if(n.img){if(n.rl&&n.rl!="void(0);"){o.push(['<a href="',n.rl,'" target="_blank" onclick="return QBS.click(\'',n.cl,'\',false,true);" title="',n.txt,'" style="',t.aStyle,'">','<img src="',n.img,'" alt="',n.txt,'"/>',"</a>"].join(""))}else{o.push(["<span onclick=\"QBS.click('",n.cl,'\',false,true);" title="',n.txt,'" style="',t.aStyle,'">','<img src="',n.img,'" alt="',n.txt,'"/></span>'].join(""))}}}
}else if(t.type=="textlink"){for(var i=0;i<e.data.length;i++){var n=e.data[i];o.push(['<a href="',n.rl,'" target="_blank" onclick="return QBS.click(\'',n.cl,'\',false,true);" style="',t.aStyle,'">',n.txt,"</a>"].join(""))}}return o.join("")};QZBlog.Util.parseMentionStr=function(){var e=function(e){return e&&e.replace(/(%2C|%25|%7D)/g,function(e){return unescape(e).toInnerHTML()})};return function(t){if(!t||t.indexOf("@")<0){return t}t=t.replace(/%3A/g,":").replace(/%2C/g,",");t=t.replace(/@\{uin:([^\}]*),nick:([^\}]*?)(?:,who:([^\}]*))?(?:,auto:([^\}]*))?\}/g,function(t,o,i){o=escape(o.toInnerHTML());var n=(/\D/g.test(o)?"http://xiaoyou.qq.com/index.php?mod=profile&u=":"http://user.qzone.qq.com/")+o;return"<a href="+n+' target="_blank">@'+e(i)+"</a>"});return t}}();QZBlog.Util.protectMentionStr=function(e){var t=e.replace(/(@\{uin:[^\}]*,\s*nick:)([^\}]*?)(,|})/g,function(e,t,o,i){return t+o.toInnerHTML()+i});return t};QZBlog.Logic.deleteBlog=function(e,t,o,i,n){var r
;if(QZFL.lang.isArray(e)){r=e.join("_")}else{r=e}var a={uin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),idList:r,blogType:i||0,incharset:"utf-8",outcharset:"utf-8"};if(n){a["delForce"]=true}var l=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("del_blog"),charset:"utf-8",data:a,method:"post",uniqueCGI:true});l.onSuccess=function(e){QZBlog.Util.showMsgbox("删除成功！",4,QZBlog.Util.MSG_LIFTTIME.MIDDLE);t&&t(e)};l.onError=function(e){o&&o(e)};l.send()};QZBlog.Logic.setBlogTop=function(e,t){if(!e){return}var o={uin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),blogId:e.getID(),topFlag:e.getTopFlag()?0:1};var i=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("mod_blog_effect"),data:o,method:"post",uniqueCGI:true});i.onSuccess=function(){QZBlog.Logic.refreshTopData();e.setTopFlag(!e.getTopFlag());e.updateRandomSeed();parent.BlogListNavigator.removePageData();var o=parent.g_oBlogInfoMgr.getBlogInfo(e.getID())
;parent.g_oBlogInfoMgr.removeBlogInfo(e.getID());if(!!o){o.updateRandomSeed();o.setTopFlag(e.getTopFlag())}if(typeof t=="function"){t()}};i.send()};QZBlog.Logic.recommendBlog=function(e){QZBlog.Util.popupDialog("推荐日志",{src:"https://"+location.hostname+"/proxy/domain/qzs.qq.com/qzone/app/blog/dialog/recommend_blog_dlg.html?blogid="+e},340,265)};QZBlog.Logic.convertBlogToPrivate=function(e,t,o){var i="https://"+location.hostname+"/proxy/domain/qzs.qq.com"+IMGCACHE_BLOG_V5_PATH+"/convert_blog_dlg.html?blogid="+e+"&mode="+(t?1:0);QZBlog.Util.popupDialog("转为私密日志",{src:i},398,185)};QZBlog.Logic.refreshTopData=function(){parent.isRefreshTop=true;PAGE_CACHE.clean("HostRecentBlogList")};QZBlog.Logic.clearMusicPlayer=function(){try{if(!!window.bTopPageMusicStop){QZONE.cookie.set("pausemusic","0");if(parent.window.musicJSReady){parent.Qplay(parent.getPlayingPos())}}__flash__removeCallback=function(){};__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};g_insertSwfNum=0
;clearTimeout(parent.g_nBlogMusicTimer);clearMusicData()}catch(e){}};QZBlog.Logic.initMusicPlayer=function(){var e=function(e){var t=e.toRealStr().replace(/<|>/g,"").replace(/"|'/g,"");return t};return function(){var t=document.getElementsByName("musicFlash**");if(t.length>0){var o=[];for(var i=0;i<t.length;++i){var n=t[i].getAttribute("ubb");n=e(n);if(!!n){o.push(n);if(!QZFL.userAgent.ie){var r=n.split("|").length>7;var a=parseInt(t[i].width,10);var l=parseInt(t[i].height,10);var s=r?200:120;var g=r?386:360;var c="//"+IMGCACHE_DOMAIN+"/music/musicbox_v2_1/img/MusicFlash.swf";var u=document.createElement("span");u.style.cssText="display:inline-block; height:"+s+"px;width:"+g+"px; overflow:hidden; vertical-align:baseline";var d=t[i].parentNode;d.replaceChild(u,t[i])
;u.innerHTML='<object type="application/x-shockwave-flash" data="'+c+'" width="'+a+'" height="'+l+'" name="musicFlash'+(o.length-1)+'" id="musicFlash'+(o.length-1)+'" align="middle" ubb="'+n+'">'+'<param name="movie" value="'+c+'" />'+'<param name="quality" value="high" />'+'<param name="bgcolor" value="#ffffff" />'+'<param name="play" value="true" />'+'<param name="loop" value="true" />'+'<param name="wmode" value="transparent" />'+'<param name="scale" value="showall" />'+'<param name="menu" value="true" />'+'<param name="salign" value="" />'+'<param name="allowScriptAccess" value="always" />'+"</object></span>";i--}else{t[i].id="musicFlash"+(o.length-1);if(QZFL.userAgent.ie<9){t[i].name="musicFlash"+(o.length-1)}}}}if(o.length>0){var f=new QZONE.jsLoader;f.onload=function(){initMusicData.apply(null,o)};f.load("//qzonestyle.gtimg.cn/music/musicbox_v2_1/js/musicblog_player.js",document,"GB2312")}}}}();QZBlog.Logic.initVideoPlayer=function(){var e={UGC:1,TXVIDEO:51};function t(e){
for(var t=0;t<e.length;t++){if(e[t].tagName.toUpperCase()=="EMBED"){if(e[t].parentNode.tagName.toUpperCase()=="OBJECT"&&(e[t].parentNode.className=="blog_video"||e[t].parentNode.className=="blog_qqVideo")){e.splice(t,1);t--}}}return e}function o(e){var t=e.getAttribute("data-vid");var o=e.getAttribute("videothumb");if(!t){var i=decodeURIComponent(QZONE.FP.getParameter(e.getAttribute("src")||"","vurl")).match(/\d{4}_[\w\d]{32}.f[\d]{1,2}/);if(i&&i[0]){t=i[0]}}if(!t){t=QZONE.FP.getParameter($e("embed",e).getAttr("src")||"","vid")}if(!t){reportAtta(1,101);if(e.innerHTML.indexOf("qq.com")!==-1){reportAtta(1,102)}e.parentNode.removeChild(e);console.log("视频播放地址，删除节点",e.getAttribute("src"));return}if(!o){o=decodeURIComponent(QZONE.FP.getParameter(e.getAttribute("src")||"","pic"))||""}var n="https://h5.qzone.qq.com/video/index?vid="+t;if(o){n+="&poster="+encodeURIComponent(o)}var r=document.createElement("iframe");var a=e.getAttribute("width");var l=e.getAttribute("height");r.height=l
;r.width=a;r.src=n;e.parentNode.replaceChild(r,e)}function n(e){var t=e.getAttribute("data-vid");if(!t){var o=e.getAttribute("data");if(o){t=QZONE.FP.getParameter(o,"vid")||""}}if(!t){t=QZONE.FP.getParameter(e.getAttribute("src")||"","vid")}if(!t){t=QZONE.FP.getParameter($e("embed",e).getAttr("src")||"","vid")}if(!t){reportAtta(1,100);videoContainers[i].parentNode.removeChild(e);console.log("视频取不到vid，删除节点",e.getAttribute("data"));return}var n=e.getAttribute("width");var r=e.getAttribute("height");var a=e.getAttribute("autostart")||false;var l=document.createElement("iframe");var s="https://v.qq.com/txp/iframe/player.html?vid="+t;if(a){s+="&autoplay=true"}l.src=s;l.height=r;l.width=n;l.setAttribute("allowFullScreen",true);e.parentNode.replaceChild(l,e)}function r(t){var o=t.getAttribute("data-type");if(o){return o}var i=t.getAttribute("src");if(i){if(i.indexOf("Main.swf")>0){return e.UGC}else if(i.indexOf("qqplayerout.swf")>0){return e.TXVIDEO}}var n=t.getAttribute("data")
;if(n&&n.indexOf("cache.tv.qq.com")>-1){return e.TXVIDEO}if(t.className=="blog_qqVideo"){return e.TXVIDEO}return e.UGC}return function(){var i=$e(".blog_video").elements;if(i&&i.length==0){i=$e(".blog_qqVideo").elements}if(i&&i.length==0){i=$e('embed[src*=".swf"]').elements}i=t(i);if(!i.length){return}for(var a=0;a<i.length;a++){var l=r(i[a]);reportAtta(0,1);if(l==e.TXVIDEO){reportAtta(0,2);n(i[a])}else if(l==e.UGC){reportAtta(0,3);o(i[a])}else{reportAtta(0,4);i[a].parentNode.removeChild(i[a]);console.log("不支持的视频类型",i[a].getAttribute("data"))}}}}();QZBlog.Logic.opCategory=function(e,t){var o={ADD:1,MODIFY:2,DELETE:3};var i=o[e.opType];if(e.cateName.replace(/[^\x00-\xff]/g,"hh").length>12){alert("对不起,分类名称长度不能超过12个字母/6个汉字");return false}if(e.cateName=="近期日志"||e.cateName=="往期日志"||e.cateName==parent.BLOG_DEFAULT_CATENAME){alert("对不起，不能使用“"+e.cateName+"”作为分类名称");return false}var n={hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),cateName:e.cateName.replace(/[\x00-\x20 ]/g," ")||null,opType:i}
;if(e.opType=="MODIFY"){n.oldCateName=e.oldCateName;n.oldCateHex=e.oldCateHex}else if(e.opType=="DELETE"){n.cateHex=e.cateHex}var r=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("op_cate"),data:n,method:"post",uniqueCGI:true});r.onSuccess=function(o){o.data.cateName=e.cateName;try{t&&t(o)}catch(e){}return true};r.send()};QZBlog.Logic.showAddCategoryDlg=function(e){parent.addBlogCategoryCallback=function(t){e(t);QZBlog.Util.closePopup()};QZBlog.Util.popupDialog("添加日志分类",{src:"https://"+location.hostname+"/proxy/domain/qzs.qq.com"+IMGCACHE_BLOG_V5_PATH+"/add_category_dlg.html"},380,115)};QZBlog.Logic.setBlogSetting=function(e,t,o){e=e+"&uin="+QZBlog.Logic.SpaceHostInfo.getLoginUin()+"&pwd2sig="+QZBlog.Util.getPwd2Sig();var i=QZBlog.CGI_URL.get("blog_set_bitmap");var n=new QZBlog.Util.NetRequest({url:i,data:e,method:"post",isSilenderMode:o});n.onSuccess=function(){t&&t()};n.send()};QZBlog.Logic.convertToBlog=function(e){parent.blogPopupCallback=function(t,o){e(t,o)}
;QZBlog.Util.popupDialog("转为日志",{src:"https://"+location.hostname+"/proxy/domain/qzs.qq.com/qzone/newblog/v5/convert_toblog_dlg.html"},482,183)};QZBlog.Logic.setBlogRight=function(e,t){var o=e.getRightInfo();if(!o){return}parent.blogPopupCallback=function(o,i){if(!o){return}var n=QZBlog.CGI_URL.get("mod_blog_right");var r={uin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),idList:e.getID(),rightType:o};var a=[];if(o==2){a.push({cateid:1,groupid:2});if(i&&i.noticeInfoFlag){r["feeds"]=1}}else if(o==3){var l=[];for(var s=0;s<i.length;s++){l.push(i[s].data);a.push({cateid:128,groupid:i[s].data})}r["specUins"]=l.join(",")}else if(o==4){a.push({cateid:4,groupid:4})}var g=new QZBlog.Util.NetRequest({url:n,data:r,method:"post",uniqueCGI:true});g.onSuccess=function(){QZBlog.Util.showMsgbox("设置成功",4,QZBlog.Util.MSG_LIFTTIME.MIDDLE);var i=new parent.BlogRightInfo;i.convertJsonObject(a);e.setRightInfo(i);e.updateRandomSeed();e.setEffectBit(29,o==1?false:true)
;QZBlog.Logic.refreshTopData();if(!!t){t()}};g.send()};var i="";var n=o.getType();if(n==parent.BlogRightInfo.RIGHTTYPE["SPECIFIC"]){i=o.getUserIDList().join("|")}if(!i)i="";var r=IMGCACHE_BLOG_V5_PATH;if(location.href.indexOf("g_iframeUser=1")>-1){r="//"+location.hostname+"/proxy/domain/qzs.qq.com"+IMGCACHE_BLOG_V5_PATH}QZBlog.Util.popupDialog("权限设置",{src:r+"/right_setting_dlg.html?specuins="+i+"&right="+n},482,78)};QZBlog.Logic.getCategoryInfo=function(e,t,o){if(!parent.g_oCateInfoMgr){return false}if(!o&&parent.g_oCateInfoMgr.getCategoryCnt()>0){if(e){e({data:parent.g_oCateInfoMgr.toJsonObject()})}return}var i={reqInfo:2};var n=QZBlog.CGI_URL.get("get_abs")+"?"+QZBlog.Util.buildParam(QZBlog.Util.getNewBlogListUrlData(i));var r=new QZBlog.Util.NetRequest({url:n,method:"get"});r.onSuccess=function(t){var o=0;for(var i=0;i<t.data.cateInfo.categoryList.length;++i){o+=t.data.cateInfo.categoryList[i].num}t.data.cateInfo.maxarch=Math.max(0,t.data.blog_num-o);t.data.cateInfo.blogNum=o
;parent.g_oCateInfoMgr.convertJsonObject(t.data.cateInfo);if(e){e(t)}};r.send()};QZBlog.Logic.setCategoryInfo=function(e,t,o){QZONE.FP.dialog=QZONE.FP.dialog||QZONE.FP._t.QZFL.dialog;var i=QZFL.FP.dialog.create("修改分类",{src:"https://"+location.hostname+"/proxy/domain/qzs.qq.com/qzone/newblog/v5/change_category.html"},{showMask:true,width:360,height:130,buttonConfig:[{type:QZFL.dialog.BUTTON_TYPE.Confirm,text:"确定",tips:"确定"},{type:QZFL.dialog.BUTTON_TYPE.Cancel,text:"取消",tips:"取消"}],onLoad:function(i){QZONE.FP.dialog.getById(i.id).onConfirm=function(){var i=this.dialogContent.getElementsByTagName("iframe")[0].contentWindow;var n=i.getCategoryInfo();if(n==t){QZBlog.Util.showMsgbox("您选择的分类名与原分类名相同。",2,QZBlog.Util.MSG_LIFTTIME.MIDDLE)}else{this._doChangeCategory=function(e,t,o,i){QZBlog.Util.showMsgbox("正在提交您的请求,请稍候...",6,QZBlog.Util.MSG_LIFTTIME.MIDDLE);var n=QZBlog.CGI_URL.get("mod_blog_cate");var r={uin:QZBlog.Logic.SpaceHostInfo.getLoginUin(),hostUin:QZBlog.Logic.SpaceHostInfo.getUin(),
cate:t.replace(/[\x00-\x20 ]/g," "),idList:e};var a=new QZBlog.Util.NetRequest({url:n,data:r,method:"post",uniqueCGI:true});a.onSuccess=function(){QZBlog.Util.showMsgbox("修改分类成功！",4,QZBlog.Util.MSG_LIFTTIME.MIDDLE);QZBlog.Logic.refreshTopData();parent.g_oCateInfoMgr.clear();parent.BlogListNavigator.clear();parent.BlogListNavigator.removePageData();try{o(t)}catch(e){}};a.onError=function(e){QZBlog.Util.showMsgbox(e,1,QZBlog.Util.MSG_LIFTTIME.MIDDLE);try{i()}catch(e){}};a.send()};this._doChangeCategory(e,n.toRealStr(),o,null)}}}})};QZBlog.Logic.getDateInfo=function(e,t,o){if(!!parent.g_oCateInfoMgr.getDateInfo(e)&&!o){if(t){t(parent.g_oCateInfoMgr.getDateInfo(e))}return}var i=QZBlog.CGI_URL.get("get_abs");var n={reqInfo:4,statYear:e};var r=function(){return QZBlog.Util.getNewBlogListUrlData(n)};var a=new QZBlog.Util.NetRequest({url:i,data:r,method:"get"});a.onSuccess=function(o){var i=o["data"];i["year"]=e;var n=new parent.BlogDateInfo;n.convertJsonObject(i)
;parent.g_oCateInfoMgr.setDateInfo(e,n);if(t){t(n)}};a.send()};QZBlog.Logic.getAuditCnt=function(e,t){var o="&needblog="+(e&1?1:0);o+="&needmsgb="+(e&2?1:0);o+="&needphoto="+(e&4?1:0);o+="&needshuoshuo="+(e&8?1:0);var i=QZBlog.CGI_URL.get("blog_get_unverifynum")+"?uin="+QZBlog.Logic.SpaceHostInfo.getUin()+o;var n=new QZBlog.Util.NetRequest({url:i,method:"get",uniqueCGI:true});n.onSuccess=function(e){t(e.data)};n.send()};QZBlog.Logic.getBlogViewInfo=function(e,t){t=t||QZFL.emptyFn;QZBlog.Util.getSecureSettingInfo("disable_read_counter",function(o){if(!!o){return}var i=QZBlog.CGI_URL.get("get_count")+"?type=1&uinList="+QZBlog.Logic.SpaceHostInfo.getUin()+"&idList="+e.join("_")+"&r="+Math.random();var n=new QZBlog.Util.NetRequest({url:i,method:"get",isSilenderMode:true});n.onSuccess=function(e){t(e)};n.send()})};QZBlog.Logic.getBlogCountInfo=function(e,t){QZBlog.Util.getSecureSettingInfo("disable_read_counter",function(o){if(o){return}var i=QZBlog.Util.buildParam({type:1,
uinList:QZBlog.Logic.SpaceHostInfo.getUin(),idList:e.join("_"),r:Math.random()});var n=new QZBlog.Util.NetRequest({url:QZBlog.CGI_URL.get("get_count"),data:i,method:"get",isSilenderMode:true});n.onSuccess=function(e){var o={};var i=QZFL.object.route(e,"data.itemList");if(i&&i.length){QZFL.each(i,function(e){o[e.id]={read:e.read,reply:e.reply}});t(o)}};n.send()})};QZBlog.Logic.searchTag=function(e,t){if(!e||e.length==0){return}QZONE.FP.Search(e,{entryid:57,type:"blog",appname:"日志",backurl:"/blog"+(typeof t!="undefined"?"/"+t:"")});QZBlog.Util.Statistic.sendPV("blog-tag","searchact.qzone.qq.com")};QZBlog.Logic.searchBlog=function(){var e=function(e){var t="";e=parseInt(e);if(isNaN(e)||e<=1e4){return t}e=new String(e).split("");for(var o=0;o<e.length;++o){t+=String.fromCharCode(65+parseInt(e[o],10))}return t};var t=function(){var e=$("sosoForm");if(!e){e=document.createElement("form");e.id="sosoForm";e.style.display="none";e.action="http://qzone.soso.com/qz.q";e.target="_blank"
;document.body.appendChild(e)}return e};return function(o,i,n){var r=t();r.innerHTML='<input type="hidden" name="sc" value="qz"/><input type="hidden" name="ch" value="s.qz.diary"/>'+(n=="utf-8"?'<input type="hidden" name="ie" value="utf8"/>':"")+'<input type="hidden" name="ty" value="diary"/><input type="hidden" name="w" value="'+o+'"/>'+'<input type="hidden" name="'+(!i?'cid" value="qz.s.insite" /><input type="hidden" name="site" value="'+QZBlog.Logic.SpaceHostInfo.getUin()+'" />':'cid" value="qz.s.allsite" />')+(QZBlog.Logic.SpaceHostInfo.isValidLoginUin()?'<input type="hidden" name="user" value="0'+e(QZBlog.Logic.SpaceHostInfo.getLoginUin())+'"/>':"");r.submit();parent.UserBlogConfig.setSearchOption(i)}}();QZBlog.Logic.getTweetStatus=function(){return!!QZONE.FP.getLoginBitmap(41)};QZBlog.Util.synTweetCheckState=function(e,t){if(t===undefined){
var o="http://"+(QZBlog.Logic.isInPengyou?"r.pengyou.com":"r.qzone.qq.com")+"/cgi-bin/right/get_qqbitmap.cgi?uin="+QZBlog.Util.getLoginUin()+"&g_tk="+QZBlog.Util.getToken()+"&ref="+(QZBlog.Logic.isInPengyou?"qqcampus":"qzone");var i=new QZONE.JSONGetter(o,void 0,null,"UTF-8");i.onSuccess=QZONE.event.bind(this,function(t){if(t&&t.item){var o=t&&t.items[0]&&t.items[0]["ugclog"]>0?true:false;if(e){e(o)}}});i.send("_Callback");return}else{var o="http://"+(QZBlog.Logic.isInPengyou?"w.pengyou.com":"w.qzone.qq.com")+"/cgi-bin/right/set_qqbitmap.cgi";var n={};if(!QZBlog.Logic.isInPengyou){n={uin:QZBlog.Util.getLoginUin(),ugclog:!!t?1:-1}}else{n={uin:QZBlog.Util.getPengyouDecodeUin(),ugclog:!!t?1:-1}}var r=new QZONE.FormSender(o,"post",n,"UTF-8");r.onSuccess=function(e){};r.onError=function(e){};r.send()}};QZBlog.Logic.procBlogContent=function(){var e="QZBLOG_IMG_LOADING";var t=0;var o="data-img-idx";var i=function(e){if(r(e)){return e.replace(/(.*)(\&|&amp;|\?)t=5($|&)(.*)/i,"$1$2$4")}return e
};var n=function(e){return new RegExp("^http://\\w+\\.photo\\.store\\.qq\\.com/","i").test(e)||new RegExp("^http://\\w+\\.qpic\\.cn\\/","i").test(e)};var r=function(e){return n(e)&&/(.*)(\&|&amp;|\?)t=5($|&.*)/i.test(e)};var a=function(e,t){var o=e.parentNode,i;if(o){if(t&&e.hasChildNodes()){while(i=e.firstChild){o.insertBefore(i,e)}}o.removeChild(e)}return e};var l=function(e,t){var o=document.createElement("span");o.innerHTML=e;t.parentNode.insertBefore(o,t);if(t.style.cssText){o.style.cssText=t.style.cssText}else{a(o,true)}t.parentNode.removeChild(t)};var s=function(r,a){var l=r.getAttribute("orgSrc");var s=r.getAttribute("src");if(QZBlog.Util.isNonsenseImg(l||s)){return}var g=t++;var c=function(t,n){var r=parseInt(t.offsetWidth||t.style.width,10)||0,l=parseInt(t.offsetHeight||t.style.height,10)||0;var s=QZBlog.Util.scaleRegion(r,l,a);if(s){QZFL.dom.setStyle(t,s)}t.removeAttribute("orgSrc");QZFL.css.removeClassName(t,e);t.setAttribute(o,g);t.setAttribute("data-src",i(n))}
;if((/loaded|complete/.test(r.readyState)||r.complete)&&!QZBlog.Util.isNonsenseImg(r.src)){console.log("图片加载完成 &　非透明占位图",r.src);c(r,s)}else{QZFL.event.addEvent(r,"load",function(){if(!QZBlog.Util.isNonsenseImg(this.src)){c(this,l||this.src)}});if(l){if(n(l)&&QZFL.userAgent.ie&&QZFL.userAgent.ie>8){QZONE.FP._t.seajs.use("photo.v7/common/webp/webp2Base64/webp2Base64",function(e){e.getImgBase64({url:l+"&t=5",callback:function(e){console.log("base64 转换:",l+"&t=5");console.log("base64 转换结果:",e);r.src=e[0]}})})}else{r.src=l}}}};var g=function(e){if(!e.getAttribute("data-webp-ctx-e")){e.setAttribute("data-webp-ctx-e",1);QZFL.event.addEvent(e,"mousedown",function(e){var t=QZFL.event.getButton(e);var o=QZFL.event.getTarget(e);if(o.nodeName.toLowerCase()=="img"&&t!=0){var i=o.getAttribute("data-src");if(i&&i!=o.src){console.log("webp 右键替换图片",i);o.removeAttribute("data-src");o.src=i}}})}};return function(e,t){console.log("处理日志正文内容");if(!e){return}g(e);var t=QZFL.object.extend({letterFlag:false,
previewMode:false,maxPreloadCnt:1e6},t||{});var o=QZBlog.Util.isWideMode()?870:670;if(t.letterFlag){o=QZBlog.Util.isWideMode()?847:630}if(QZBlog.Util.isFreeMode()){o=QZBlog.Util.getFreeModeMaxMediaWidth()}var i=e.getElementsByTagName("IMG");QZFL.each(i,function(e){s(e,o)});flashList=e.getElementsByTagName("EMBED");QZFL.each(flashList,function(e){var t=parseInt(e.getAttribute("width"),10)||0;var i=parseInt(e.getAttribute("width"),10)||0;if(t>o){e.style.width=o+"px";if(i&&i*(o/t)>0){e.style.height=i*(o/t)+"px"}}});PageScheduler.blogInfo=PageScheduler.blogInfo||PageScheduler.curBlogInfo;if((t.previewMode||PageScheduler&&PageScheduler.blogInfo&&PageScheduler.blogInfo.getEffectBit(39))&&!!$("pagestyle")){var n=$("pagestyle").sheet||document.styleSheets["pagestyle"];var r=QZBlog.Logic.getSpecialFontNameList(e.innerHTML);QZBlog.Logic.loadSpecialFontLib(n,r);if(r.length>0&&$("topHintArea")){if(!QZONE.userAgent.ie&&!t.previewMode){
$("topHintArea").innerHTML='<div class="hint"><strong class="icon_hint"><span>提示</span></strong> <span>本篇日志使用了<a href="http://qzone.qq.com/helpcenter/yellow_info.htm?56" target="_blank" class="c_tx4">个性字体</a>，请使用IE浏览器查看完整效果。</span> <a href="javascript:void(0)" title="关闭" onclick="$(\'topHintArea\').style.display = \'none\';return false;" class="hint_close">关闭</a></div>'}if(QZONE.userAgent.ie){$("topHintArea").innerHTML='<div class="hint"><strong class="icon_hint"><span>提示</span></strong> <span>您可以<a href="javascript:;" onclick="InfoManager.switchSpecialFont(false);return false;" class="c_tx4">使用普通字体</a>查看，使用个性字体的部分将恢复为宋体，此操作有可能打乱文字现有排版。</span> <a href="javascript:void(0)" title="关闭" onclick="$(\'topHintArea\').style.display = \'none\';return false;" class="hint_close">关闭</a></div>'}}}}}();QZBlog.Logic.appealBlog=function(){var e=function(e,t,o){QZBlog.Util.popupDialog("QQ空间申诉平台",{src:e},t,o);QZONE.FP._t.appeal_onClose=function(){QZONE.FP.closePopup()}};return function(t){
var o="//jubao.qq.com/cn/appeal/appeal?appname=appeal&subapp=qzone_blog&jubaotype=article&uin="+QZBlog.Logic.SpaceHostInfo.getUin()+"&blogid="+t;e(o,629,510)}}();QZBlog.Logic.showReport=function(e){var t=633;var o=483;var i=parent.$("jubao_div");if(!i){i=QZONE.dom.createElementIn("div",parent.document.body,false,{id:"jubao_div",style:"position:absolute; display:none; width:"+t+"px; height:"+o+"px; z-index: 999; padding:0; margin:0px;"})}parent.jubao_onResize=function(e,t){login_wnd=$("jubao_div");if(!login_wnd){return}login_wnd.style.width=e+"px";login_wnd.style.height=t+"px";login_wnd.style.visibility="hidden";login_wnd.style.visibility="visible"};parent.jubao_onClose=function(){login_wnd=parent.$("jubao_div");if(!login_wnd){return}login_wnd.style.display="none";login_wnd.innerHTML="";if(parent.reportMaskID){QZONE.maskLayout.remove(parent.reportMaskID)}parent.reportMaskID=0};var n=(parent.QZONE.dom.getClientWidth()-t)/2+parent.QZONE.dom.getScrollLeft()
;var r=Math.max((parent.QZONE.dom.getClientHeight()-o)/2+parent.QZONE.dom.getScrollTop(),0);i.style.left=n+"px";i.style.top=r+"px";parent.reportMaskID=QZFL.maskLayout.create(100,parent.document);i.innerHTML='<iframe name="jubao_frame" id="jubao_frame" frameborder="0" scrolling="no" width="100%" height="100%" src="'+e+'"></iframe>';i.style.display=""};QZBlog.Logic.gotoVipInfo=function(e){if(e==QZBlog.Util.getSpaceUin()){QZBlog.Util.toApp("/yellowgrade")}else{window.open("//user.qzone.qq.com/"+e+"/yellowgrade")}};QZBlog.Logic.getSpecialFontNameList=function(e){var t=[];e=e.replace(/<(font|span)([^>]+)>/gi,function(){var e=/face=("|)([^"\s]+)("|)/.exec(arguments[2]);if(e&&e[2]){for(var o in g_specialFontList){if(e[2].indexOf(g_specialFontList[o]["className"])!=-1){t.push(o)}}}return arguments[0]});e=e.replace(/<(div|span)([^>]+)>/gi,function(){var e=/font-family:([^;^"]+)/gi.exec(arguments[2]);if(e&&e[1]){for(var o in g_specialFontList){
if(e[1].indexOf(g_specialFontList[o]["className"])!=-1){t.push(o)}}}return arguments[0]});return QZFL.lang.uniqueArray(t)};var g_specialFontList={"豆豆体":{exampleName:"豆豆体",classPrefix:"qzone_font_dou",className:"dou",urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCDOU0.eot",fontLibLoaded:false,tryid:50,succid:51},"桃心体":{exampleName:"桃心体",classPrefix:"qzone_font_tao",className:"tao",urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCLOVE0.eot",fontLibLoaded:false,tryid:52,succid:53},"小花体":{exampleName:"小花体",classPrefix:"qzone_font_xiaohua",className:"xiaohua",urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCHUAYU0.eot",fontLibLoaded:false,tryid:58,succid:59},"清秀体":{exampleName:"清秀体",classPrefix:"qzone_font_qingxiu",className:"qingxiu",urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCQINGX0.eot",fontLibLoaded:false,tryid:79,succid:80},"花卷体":{exampleName:"花卷体",classPrefix:"qzone_font_huajuan",className:"huajuan",
urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCHUAJU0.eot",fontLibLoaded:false,tryid:81,succid:82},"钢笔体":{exampleName:"钢笔体",classPrefix:"qzone_font_pen",className:"fountainpen",urlPath:"//"+IMGCACHE_DOMAIN+"/qzonestyle/act/font/eot/TCGANGB0.eot",fontLibLoaded:false,tryid:211,succid:212}};QZBlog.Logic.loadSpecialFontLib=function(e,t){if(!e){return}if(QZFL.userAgent.ie){var o="";for(var i=0;i<t.length;++i){if(g_specialFontList[t[i]]){o+="\n@font-face { font-family: "+g_specialFontList[t[i]]["className"]+"; font-style: normal;font-weight: normal;src: url("+g_specialFontList[t[i]]["urlPath"]+");}\n"}}if(o.length>0){setTimeout(function(){e.cssText+=o},50)}}};QZBlog.Logic.enableSpeicialFontEffect=function(e,t){if(!e){return}var o=[];for(var i in g_specialFontList){o.push(g_specialFontList[i]["className"])}if(!t){var n=new RegExp("(font-family: )("+o.join("|")+")","ig");e.cssText=e.cssText.replace(n,function(){return arguments[1]+arguments[2]+"_dump"});delete n}else{
var n=new RegExp("(font-family: )("+o.join("|")+")(_dump)","ig");e.cssText=e.cssText.replace(n,function(){return arguments[1]+arguments[2]});delete n}};QZBlog.Logic.showHotMess=function(e){var t=$("hot_mess");if(!t){return}if(typeof QBS=="undefined"&&!e){QZFL.imports("http://"+IMGCACHE_DOMAIN+"/qzone/biz/comm/js/qbs.js",function(){QZBlog.Logic.showHotMess(true)});return}var o=function(e){try{t.innerHTML="<a href='"+e.data[0]._l+"' target='_blank' onclick='return QBS.click(\""+e.data[0].cl+"\", false, true);' class='unline'>"+e.data[0].txt+"</a>";QZONE.css.removeClassName(t,"none")}catch(e){}};QBS.get("qzone_blogright_txt_1",t,1,false,o)};QZBlog.Logic.showPageHintInfo=function(e,t,o){if(typeof o!="string"){o="pageHintArea"}var i=$(o);if(!i){i=QZONE.dom.createElementIn("div",t?t:document.body,true,{id:o})}
var e='<div class="hint"><strong class="icon_hint"><span>提示</span></strong><span>'+e+"</span>"+'<a href="javascript:;" title="关闭提示" class="hint_close" onclick="$(\''+o+"').style.display='none';return false;\"></a></div>";i.innerHTML=e;i.style.display=""};(function(){var e={};this.tmpl=function t(o,i){var n=!/\W/.test(o)?e[o]=e[o]||t(document.getElementById(o).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');");return i?n(i):n}})();QZBlog.Util.getSplitTime=function(e){var t=new Date(e.replace(/-/g,"/")),o=new Date,i;if(t.getFullYear()){i=o-t;if(i<0){return""}else if(i<=36e5){return"1小时内"}else if(i>36e5&&i<=864e5){return Math.ceil(i/36e5)+"小时内"}else if(i>864e5){return e.replace(/\s.*$/,"")}else{return""}}else{return""}}
;QZBlog.Logic.showClinic=function(e){QZBlog.Util.popupDialog("温馨提示",{src:"https://"+location.hostname+"/proxy/domain/qzs.qq.com"+IMGCACHE_BLOG_V5_PATH+"/clinic_tip.html?flag="+(typeof e=="undefined"?true:false)},450,170)};function getCursorPosition(e){var t={text:"",start:0,end:0};e.focus();if(e.setSelectionRange){t.start=e.selectionStart;t.end=e.selectionEnd;t.text=t.start!=t.end?e.value.substring(t.start,t.end):""}else if(document.selection){var o,i=document.selection.createRange(),n=document.body.createTextRange();n.moveToElementText(e);t.text=i.text;t.bookmark=i.getBookmark();for(o=0;n.compareEndPoints("StartToStart",i)<0&&i.moveStart("character",-1)!==0;o++){if(e.value.charAt(o)=="\n"){o++}}t.start=o;t.end=t.text.length+t.start}return t}function setCursorPosition(e,t){if(!t){}if(e.setSelectionRange){e.focus();e.setSelectionRange(t.start,t.end)}else if(e.createTextRange){var o=e.createTextRange();if(e.value.length===t.start){o.collapse(false);o.select()}else{
o.moveToBookmark(t.bookmark);o.select()}}}try{if($("pageContainer"))$("pageContainer").className=QZBlog.Util.isWideMode()?"blog big_mode_blog":!QZBlog.Util.isSmallMode()?"blog full_mode_blog":"blog mini_mode_blog";QZONE.event.addEvent(window,"beforeunload",function(){QZBlog.Util.TimerManager.clear()});if(location.host=="blog.qq.com"){QZFL.imports("http://js.aq.qq.com/js/aq_common.js")}}catch(e){}